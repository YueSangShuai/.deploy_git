<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/fluid.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/fluid.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yuesangshuai.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="你好陌生人">
<meta property="og:url" content="http://yuesangshuai.github.io/index.html">
<meta property="og:site_name" content="你好陌生人">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="YueSang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yuesangshuai.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>你好陌生人</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>
<script src="/live2d-widget/autoload.js"></script>
<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">你好陌生人</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="fa fa-book fa-fw"></i>guestbook</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%A9%B7%E8%8B%A6%E4%BA%BA%E6%B0%91%E5%A6%82%E4%BD%95%E7%94%A8%E7%A7%BB%E5%8A%A8%E5%9B%BA%E6%80%81%E9%85%8D%E7%BD%AEunbutu22.04_awesome-terminal-fonts-CS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%A9%B7%E8%8B%A6%E4%BA%BA%E6%B0%91%E5%A6%82%E4%BD%95%E7%94%A8%E7%A7%BB%E5%8A%A8%E5%9B%BA%E6%80%81%E9%85%8D%E7%BD%AEunbutu22.04_awesome-terminal-fonts-CS/" class="post-title-link" itemprop="url">穷苦人民如何用移动固态配置unbutu22.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 10:37:19 / 修改时间：11:16:45" itemprop="dateCreated datePublished" datetime="2024-01-09T10:37:19+08:00">2024-01-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" itemprop="url" rel="index"><span itemprop="name">环境配置</span></a>
                </span>
            </span>

          
            <span id="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%A9%B7%E8%8B%A6%E4%BA%BA%E6%B0%91%E5%A6%82%E4%BD%95%E7%94%A8%E7%A7%BB%E5%8A%A8%E5%9B%BA%E6%80%81%E9%85%8D%E7%BD%AEunbutu22.04_awesome-terminal-fonts-CS/" class="post-meta-item leancloud_visitors" data-flag-title="穷苦人民如何用移动固态配置unbutu22.04" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%A9%B7%E8%8B%A6%E4%BA%BA%E6%B0%91%E5%A6%82%E4%BD%95%E7%94%A8%E7%A7%BB%E5%8A%A8%E5%9B%BA%E6%80%81%E9%85%8D%E7%BD%AEunbutu22.04_awesome-terminal-fonts-CS/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%A9%B7%E8%8B%A6%E4%BA%BA%E6%B0%91%E5%A6%82%E4%BD%95%E7%94%A8%E7%A7%BB%E5%8A%A8%E5%9B%BA%E6%80%81%E9%85%8D%E7%BD%AEunbutu22.04_awesome-terminal-fonts-CS/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="穷苦人民如何用移动固态配置unbutu22-04"><a href="#穷苦人民如何用移动固态配置unbutu22-04" class="headerlink" title="穷苦人民如何用移动固态配置unbutu22.04"></a>穷苦人民如何用移动固态配置unbutu22.04</h1><p>(这篇博客大部分都是查找的别人的博客或者CSDN我对这些内容进行整理出来的，如果有侵权请联系我)</p>
<p>因为深度学习大部分用的是linux系统，而且之后很多代码也要部署到nuc和nx上，但是我刚好又在外面实习，在电脑空间不足的情况下我选择使用移动固态作为unbutu的系统盘</p>
<p>对于显卡的部分我放在cuda,cudnn,tensorrt一起讲</p>
<h2 id="一-unbutu系统的安装"><a href="#一-unbutu系统的安装" class="headerlink" title="一.unbutu系统的安装"></a><a href="#"></a>一.unbutu系统的安装</h2><p>具体可以详见这位大佬的CSDN：<a target="_blank" rel="noopener" href="https://www.edwardzcn98yx.com/post/8bb234ab.html" title="UbuntuToGo——打造属于自己的移动固态热插拔Liniux操作系统 - Edward&#39;s blog">UbuntuToGo——打造属于自己的移动固态热插拔Liniux操作系统 - Edward’s blog</a></p>
<p>这里提几点需要注意的事项</p>
<p>&nbsp;1.安装的时候看好盘，不要把你默认的window盘格式化掉</p>
<p>&nbsp;2.记得选择其他选项</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/e8c99bb2c1e248d89a1b3c4a2c0d314f_9ddf4445e29b4cd59.png"></p>
<p>3.首先要选择你的主板对应的ubuntu版本，因为我的电脑是y9000p用20.04的话是连不上WIFE所以我采用了最新的22.04版本并且可以成功连接上WIFE</p>
<p>4.个人建议是安装英文版本的ubuntu之后可以在设置里面改成中文，但是文件夹名字依然为英文避免英文路径出错。</p>
<p>5.我移动硬盘是512g,硬盘装ubuntu系统分区是要自己去划分的；这里我给出我的分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.  #以下单位为MB</span><br><span class="line">    </span><br><span class="line">2.  swap 16384 #交换区一般给内存的大小，16g的可以多给1-2G</span><br><span class="line">    </span><br><span class="line">3.  /home 225820 #建议多给点</span><br><span class="line">    </span><br><span class="line">4.  /boot 1024</span><br><span class="line">    </span><br><span class="line">5.  EIF 256</span><br><span class="line">    </span><br><span class="line">6.  /tmp 5120 #这里是个坑，我在配置cuda的时候踩到了</span><br><span class="line">    </span><br><span class="line">7.  /  #剩下的空间都给他，建议大点</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对于22的颜值我首先是表示肯定的</p>
<img width="1200" height="746" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/b5aa7604a9534f4aac8f267432ed929d_0e77ecf57bbe452aa.png" class="jop-noMdConv">

<p>是不是有点window那味了</p>
<h2 id="二-关于语言以及中文输入法"><a href="#二-关于语言以及中文输入法" class="headerlink" title="二.关于语言以及中文输入法"></a><a href="#"></a>二.关于语言以及中文输入法</h2><p>进入setting-&gt;区域与语言，之后选择管理已安装的语言</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/1423bd21f24d4b72bc99006f7d72dcc6_ca4cffa938d947c6b.png"></p>
<p>添加语言中选择汉语，</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/6ea0ae63aee048c4a9e2b7f1835e30cf_d79e25afc14e43e28.png"></p>
<p>&nbsp;键盘这里选择+号，添加ibus中文输入法</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/f9dbede4c7874791b8ef7d19845d037e_46536698b9544bbab.png"></p>
<h2 id="三-给ubuntu换源"><a href="#三-给ubuntu换源" class="headerlink" title=" 三.给ubuntu换源"></a><a href="#"></a> 三.给<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ubuntu%E6%8D%A2%E6%BA%90&spm=1001.2101.3001.7020">ubuntu换源</a></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/apt/sources.list</span><br></pre></td></tr></table></figure>

<p>清华</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">1.  # 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class="line">    </span><br><span class="line">2.  deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">3.  # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">4.  deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">5.  # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">6.  deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">7.  # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">8.  deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">9.  # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">11. # 预发布软件源，不建议启用</span><br><span class="line">    </span><br><span class="line">12. # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">13. # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse </span><br></pre></td></tr></table></figure>

<p>阿里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1.  deb http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">2.  deb-src http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">3.  deb http://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">4.  deb-src http://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">5.  deb http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">6.  deb-src http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">7.  deb http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">8.  deb-src http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">9.  deb http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">10. deb-src http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>中科大</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> 2.  deb https://mirrors.ustc.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">3.  deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">4.  deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">5.  deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">6.  deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">7.  deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">8.  deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">9.  deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-security main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">10. deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">11. deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse </span><br></pre></td></tr></table></figure>

<p>（个人觉得中科大的比较快）然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo apt-get update</span><br><span class="line">    </span><br><span class="line">2.  sudo apt-get upgrade</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>完成ubuntu源的更新</p>
<h2 id="四-下载谷歌浏览器"><a href="#四-下载谷歌浏览器" class="headerlink" title="四.下载谷歌浏览器"></a><a href="#"></a>四.下载谷歌浏览器</h2><h3 id="1-通过使用Ctrl-Alt-T键盘快捷键或单击终端图标来打开终端"><a href="#1-通过使用Ctrl-Alt-T键盘快捷键或单击终端图标来打开终端" class="headerlink" title="1.通过使用Ctrl+Alt+T键盘快捷键或单击终端图标来打开终端"></a><a href="#"></a>1.通过使用<code>Ctrl+Alt+T</code>键盘快捷键或单击终端图标来打开终端</h3><p>使用wget下载最新的Google Chrome <code>.deb</code>软件包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb</span><br></pre></td></tr></table></figure>

<h3 id="2-安装Google-Chrome"><a href="#2-安装Google-Chrome" class="headerlink" title="2.安装Google Chrome"></a><a href="#"></a>2.安装Google Chrome</h3><p>在Ubuntu上安装软件包需要管理权限。以<a target="_blank" rel="noopener" href="https://www.iplayio.cn/post/816316675" title="具有sudo特权">具有sudo特权</a>的用户身份运行以下命令，以<code>.deb</code>在系统上安装Chrome 软件包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ./google-chrome-stable_current_amd64.deb</span><br></pre></td></tr></table></figure>

<p>个人建议最好科学上网一下可以把window下谷歌的一些配置导入进来</p>
<h2 id="五-微信的安装"><a href="#五-微信的安装" class="headerlink" title="五.微信的安装"></a><a href="#"></a>五.微信的安装</h2><p><strong>添加仓库</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> 1.   sudo apt-get update  </span><br><span class="line">    </span><br><span class="line">2.   sudo wget -O- https://deepin-wine.i-m.dev/setup.sh | sh</span><br></pre></td></tr></table></figure>

<p><strong>安装</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install synaptic</span><br></pre></td></tr></table></figure>

<p><a href="#"></a><strong>卸载</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove --purge synaptic</span><br></pre></td></tr></table></figure>

<p><code>--purge</code>是删除了配置文件。</p>
<p><strong>进入新得力</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo synaptic </span><br></pre></td></tr></table></figure>

<p>进入后的界面</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/89b2aec2682a40f5b394c994ffa80298_89b84160b493400ab.png"></p>
<p>&nbsp;搜索微信后直接安装</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/499cdb3df50f4b0b96f59a5defe44d98_b1d48cff15244a559.png"></p>
<h2 id="六-ubuntu界面的美化"><a href="#六-ubuntu界面的美化" class="headerlink" title="六.ubuntu界面的美化"></a><a href="#"></a>六.ubuntu界面的美化</h2><p>ubuntu22是基于gone美化的，我装了一次kde界面然后我就重装了我的系统…..先上才艺</p>
<img width="1200" height="750" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/fbbcfbc92eec4577a5bf0f5e6745668f_f8f57e87fb624e2a8.png" class="jop-noMdConv">

<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/c334ef13071c4698bf9da9370097a513_e2a193614b71455a8.png"></p>
<h3 id="1-gone美化"><a href="#1-gone美化" class="headerlink" title="1.gone美化"></a><a href="#"></a>1.gone美化</h3><p><strong>首先依赖安装</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo apt update</span><br><span class="line">    </span><br><span class="line">2.  sudo apt install gnome-tweaks chrome-gnome-shell</span><br><span class="line">    </span><br><span class="line">3.  sudo apt install gtk2-engines-murrine gtk2-engines-pixbuf </span><br><span class="line">    </span><br><span class="line">4.  sudo apt install sassc optipng inkscape libcanberra-gtk-module libglib2.0-dev libxml2-utils</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&nbsp;gnome 插件的网址是：<a href="https://link.zhihu.com/?target=https://extensions.gnome.org" title="https://extensions.gnome.org">https://extensions.gnome.org</a></p>
<p>这里建议科学上网，直接去谷歌商店安装</p>
<img width="1200" height="467" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/449f2b121cf34e08af2d4908bc4d2b07_e6e8d05c573a4c48a.png" class="jop-noMdConv">

<p>这是进入之后的页面</p>
<ul>
<li>user themes（可以把ubuntu换成mac样子的格式）</li>
<li>dash to dock（像我页面中最左边那个一样）</li>
<li>netspeed（网速测试）</li>
</ul>
<p>这几个是我装的插件</p>
<p><img width="1200" height="826" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/360845479585416e83db2f5653f8ad63_6c812ef0fd7a4c6bb.png" class="jop-noMdConv">按照好后进入这个页面进行插件的打开，点击dash to dock的设置按钮就可以进行修改了</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/6e53397555664df6911765dd10912886_b236dcce821f46a89.png"></p>
<p>&nbsp;美化包都可以从 <a href="https://link.zhihu.com/?target=https://www.gnome-look.org/" title="https://www.gnome-look.org">https://www.gnome-look.org</a> 这个网站下载的</p>
<p>Ubuntu 22.04 为所有用户提供的默认存放主题的文件夹分别如下：</p>
<ul>
<li>主题包：&#x2F;usr&#x2F;share&#x2F;themes&#x2F;</li>
</ul>
<p>将下载好的主题包解压到这个目录，或者解压后拷贝到这个目录。</p>
<ul>
<li>Icons 图标：&#x2F;usr&#x2F;share&#x2F;icons</li>
</ul>
<p>将下载好的 Icons 图标解压到这个目录，或者解压后拷贝到这个目录。</p>
<ul>
<li>鼠标图标：&#x2F;usr&#x2F;share&#x2F;icons</li>
</ul>
<p>将下载好的鼠标图标解压到这个目录，或者解压后拷贝到这个目录。</p>
<ul>
<li>选择下载的壁纸图片，右键设置为壁纸即可。</li>
</ul>
<p>上面的操作一定要保证正确无误，接下来就可以选择这些主题包，并让其生效了。</p>
<p><strong>打开 gnome-tweaks 工具，如下图：</strong></p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/a2f2db6d0cf84869880a3a747bc5623b_032faaab3fc945238.png"></p>
<p>就可以开始自定义自己的ubuntu</p>
<p>(这个部分详细可见：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/176977192" title="Ubuntu 20.04 桌面美化 - 知乎">Ubuntu 20.04 桌面美化 - 知乎</a> 我是主题的配置是按照这个大佬的来的)</p>
<h3 id="2-oh-my-zsh的安装"><a href="#2-oh-my-zsh的安装" class="headerlink" title="2.oh-my-zsh的安装"></a><a href="#"></a>2.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=oh-my-zsh&spm=1001.2101.3001.7020">oh-my-zsh</a>的安装</h3><p>说实话ubuntu自带的终端还是不够帅diao炸的所以我们玩的花一点，</p>
<h4 id="zsh的安装"><a href="#zsh的安装" class="headerlink" title="zsh的安装"></a><a href="#"></a>zsh的安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.  # 安装zsh</span><br><span class="line">    </span><br><span class="line">2.  sudo apt install zsh</span><br><span class="line">    </span><br><span class="line">3.  # 然后将zsh设置为默认shell：</span><br><span class="line">    </span><br><span class="line">4.  chsh -s /bin/zsh</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>PS：</p>
<ul>
<li><code>echo $SHELL</code>: 可以通过<code>echo $SHELL</code>查看当前默认的shell，如果没有改为<code>/bin/zsh</code>，需要重启shell。</li>
<li><code>cat /etc/shells</code>: 查看系统内已安装的shell</li>
</ul>
<h4 id="git的安装"><a href="#git的安装" class="headerlink" title="git的安装"></a><a href="#"></a>git的安装</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git</span><br></pre></td></tr></table></figure>

<h4 id="安装oh-my-zsh"><a href="#安装oh-my-zsh" class="headerlink" title="安装oh-my-zsh"></a><a href="#"></a>安装oh-my-zsh</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.  # 方式一</span><br><span class="line">    </span><br><span class="line">2.  wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br><span class="line">    </span><br><span class="line">3.  # 方式二</span><br><span class="line">    </span><br><span class="line">4.  wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh</span><br><span class="line">    </span><br><span class="line">5.  bash ./install.sh</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>安装后</p>
<p>字体的安装，没有安装图形会出现乱码（别问我怎么知道的）</p>
<p><strong>下载最新版本的符号字体和字体配置文件（下载好后直接点击文件安装就可）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  wget https://github.com/powerline/powerline/raw/develop/font/PowerlineSymbols.otf</span><br><span class="line">    </span><br><span class="line">2.  wget https://github.com/powerline/powerline/raw/develop/font/10-powerline-symbols.conf</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>powerline字体安装</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1.  # 下载</span><br><span class="line">    </span><br><span class="line">2.  git clone https://github.com/powerline/fonts.git</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">4.  # 进入文件夹并安装</span><br><span class="line">    </span><br><span class="line">5.  cd fonts</span><br><span class="line">    </span><br><span class="line">6.  ./install.sh</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>安装 Awesome-Terminal Fonts字体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.  git clone https://github.com/gabrielelana/awesome-terminal-fonts.git</span><br><span class="line">    </span><br><span class="line">2.  cd awesome-terminal-fonts</span><br><span class="line">    </span><br><span class="line">3.  ./install.sh</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>安装nerd-fonts</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.  #下载</span><br><span class="line">    </span><br><span class="line">2.  git clone https://github.com/ryanoasis/nerd-fonts.git</span><br><span class="line">    </span><br><span class="line">3.  #安装同上</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>更新字体到缓存</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.  fc-cache -vf /usr/share/fonts</span><br><span class="line">    </span><br><span class="line">2.  #vf是你的个人字体路径需要寻找一下装在哪里</span><br><span class="line">    </span><br><span class="line">3.  #以下三个目录都是字体目录</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">5.  #/usr/share/fonts</span><br><span class="line">    </span><br><span class="line">6.  #/usr/local/share/fonts</span><br><span class="line">    </span><br><span class="line">7.  #/home/&lt;username&gt;/.fonts&lt; ( &lt;username&gt;是你的用户名)</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="要是还是出现错误的情况，可以直接打开终端"><a href="#要是还是出现错误的情况，可以直接打开终端" class="headerlink" title="要是还是出现错误的情况，可以直接打开终端"></a><a href="#"></a>要是还是出现错误的情况，可以直接打开终端</h4><p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/e67fce7d344a415c868f450843dfb0c4_50024374098648a99.png"></p>
<p>&nbsp;然后选择</p>
<p>&nbsp;<img width="1200" height="428" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/7bccbad88403447fadb4977f3b4e13af_a8cef1d3c9614cd38.png" class="jop-noMdConv"></p>
<p>&nbsp;这个时候字会变得很丑，我们把自定义字体关掉就可以了啦</p>
<p>&nbsp;<img width="1200" height="625" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/00466458ba5640c7863bc2ae21f2c900_4daf4731c45d47f48.png" class="jop-noMdConv"></p>
<p>&nbsp;（这个地方我也没有搞的很明白，但是如果你的图形没办法像我一样正常显示估计就是字体问题可以自行百度poerline字体的安装方法）</p>
<h4 id="配置oh-my-zsh主题"><a href="#配置oh-my-zsh主题" class="headerlink" title="配置oh-my-zsh主题"></a><a href="#"></a>配置oh-my-zsh主题</h4><p>使用<code>sudo gedit ~/.zshrc</code>编辑<code>.zshrc</code>，将<code>ZSH_THEME</code>项改为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZSH_THEME=&quot;agnoster&quot;</span><br></pre></td></tr></table></figure>

<p>使用<code>source ~/.zshrc</code>命令更新。</p>
<h4 id="oh-my-sh插件的安装"><a href="#oh-my-sh插件的安装" class="headerlink" title="oh-my-sh插件的安装"></a><a href="#"></a>oh-my-sh插件的安装</h4><p>zsh-autosuggestions的安装（命令行命令键入时的历史命令建议插件）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/zsh-users/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestions</span><br></pre></td></tr></table></figure>

<p>zsh-<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=syntax&spm=1001.2101.3001.7020" title="syntax">syntax</a>-highlighting的安装（命令行语法高亮插件）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure>

<p>主题的修改以及插件的安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo gedit ~/.zshrc</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">3.  #不是添加而是找到对对应的变量进行修改</span><br><span class="line">    </span><br><span class="line">4.  #修改主题：ZSH_THEME</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">6.  ZSH_THEME=&quot;agnoster&quot;</span><br><span class="line">    </span><br><span class="line">7.  plugins=(</span><br><span class="line">    </span><br><span class="line">8.  	git zsh-autosuggestions zsh-syntax-highlighting</span><br><span class="line">    </span><br><span class="line">9.  )</span><br><span class="line">    </span><br><span class="line">10. #修改插件</span><br><span class="line">    </span><br><span class="line">11. plugins=(</span><br><span class="line">    </span><br><span class="line">12. 	git extract autojump zsh-autosuggestions zsh-syntax-highlighting</span><br><span class="line">    </span><br><span class="line">13. )</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后source  ~&#x2F;.zshrc一下。</p>
<h2 id="七-关于终端的美化"><a href="#七-关于终端的美化" class="headerlink" title="七.关于终端的美化"></a><a href="#"></a>七.关于终端的美化</h2><p>可以看这个大佬的CSDN：<a target="_blank" rel="noopener" href="https://blog.csdn.net/zhangjiali12011/article/details/85533482" title="ubuntu下修改终端字体颜色以及terminator字体美化_zhangjiali12011的博客-CSDN博客_terminator 美化">ubuntu下修改终端字体颜色以及terminator字体美化_zhangjiali12011的博客-CSDN博客_terminator 美化</a></p>
<p>ubuntu的安装基本到此结束，有什么问题或者错误欢迎私信我</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%E9%83%A8%E7%BD%B2c++%20%E9%85%8D%E7%BD%AEopencv4.5.5,opencv_contrib4.5.5,%E4%BB%A5%E5%8F%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%E9%83%A8%E7%BD%B2c++%20%E9%85%8D%E7%BD%AEopencv4.5.5,opencv_contrib4.5.5,%E4%BB%A5%E5%8F%8A/" class="post-title-link" itemprop="url">ubuntu22部署c++ 配置opencv4.5.5,opencv_contrib4.5.5,以及opencv下的cuda（cuda11.6,cudnn8.4.1）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 10:37:19 / 修改时间：11:16:55" itemprop="dateCreated datePublished" datetime="2024-01-09T10:37:19+08:00">2024-01-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" itemprop="url" rel="index"><span itemprop="name">环境配置</span></a>
                </span>
            </span>

          
            <span id="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%E9%83%A8%E7%BD%B2c++%20%E9%85%8D%E7%BD%AEopencv4.5.5,opencv_contrib4.5.5,%E4%BB%A5%E5%8F%8A/" class="post-meta-item leancloud_visitors" data-flag-title="ubuntu22部署c++ 配置opencv4.5.5,opencv_contrib4.5.5,以及opencv下的cuda（cuda11.6,cudnn8.4.1）" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%E9%83%A8%E7%BD%B2c++%20%E9%85%8D%E7%BD%AEopencv4.5.5,opencv_contrib4.5.5,%E4%BB%A5%E5%8F%8A/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%E9%83%A8%E7%BD%B2c++%20%E9%85%8D%E7%BD%AEopencv4.5.5,opencv_contrib4.5.5,%E4%BB%A5%E5%8F%8A/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ubuntu22部署c-配置opencv4-5-5-opencv-contrib4-5-5-以及opencv下的cuda（cuda11-6-cudnn8-4-1）"><a href="#ubuntu22部署c-配置opencv4-5-5-opencv-contrib4-5-5-以及opencv下的cuda（cuda11-6-cudnn8-4-1）" class="headerlink" title="ubuntu22部署c++ 配置opencv4.5.5,opencv_contrib4.5.5,以及opencv下的cuda（cuda11.6,cudnn8.4.1）"></a>ubuntu22部署c++ 配置opencv4.5.5,opencv_contrib4.5.5,以及opencv下的cuda（cuda11.6,cudnn8.4.1）</h1><hr>
<p>cudann一定要配置好不然<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=opencv%E9%85%8D%E7%BD%AE&spm=1001.2101.3001.7020">opencv配置</a>cuda会失败的</p>
<p>我这里采用的是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=opencv4&spm=1001.2101.3001.7020">opencv4</a>.5.5和相同版本的contribure</p>
<h2 id="一-软件的安装"><a href="#一-软件的安装" class="headerlink" title="一.软件的安装"></a><a href="#"></a>一.软件的安装</h2><p>这个部分我装了太多的依赖具体是那些我已经记不清了所以先放我成功配置看的那篇博客的依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo apt-get update</span><br><span class="line">    </span><br><span class="line">2.  sudo apt-get upgrade</span><br><span class="line">    </span><br><span class="line">3.  sudo apt-get install build-essential cmake cmake-gui unzip pkg-config</span><br><span class="line">    </span><br><span class="line">4.  sudo apt-get install libjpeg-dev libpng-dev libtiff-dev</span><br><span class="line">    </span><br><span class="line">5.  sudo apt-get install libavcodec-dev libavformat-dev libswscale-dev libgtk2.0-dev</span><br><span class="line">    </span><br><span class="line">6.  sudo apt-get install libv4l-dev libxvidcore-dev libx264-dev libtbb2 libtbb-dev libdc1394-22-dev libjasper-dev</span><br><span class="line">    </span><br><span class="line">7.  sudo apt-get install libgtk-3-dev</span><br><span class="line">    </span><br><span class="line">8.  sudo apt-get install libatlas-base-dev liblapacke-dev gfortran</span><br><span class="line">    </span><br><span class="line">9.  sudo apt-get install python3-dev</span><br><span class="line">    </span><br><span class="line">10. sudo apt-get install ffmpeg </span><br></pre></td></tr></table></figure>

<p>cmake的安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cmake-gui</span><br></pre></td></tr></table></figure>

<h2 id="二-cmake配置"><a href="#二-cmake配置" class="headerlink" title="二.cmake配置"></a><a href="#"></a>二.cmake配置</h2><p>这里我采用的的是.cache用的别人下好的东西来进行配置不然有些东西很难下载，白嫖某个大佬的连接</p>
<blockquote>
<p><strong>百度云：链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1XaYIAc6wDoWrtLaHRJs5Qg?pwd=kksk">https://pan.baidu.com/s/1XaYIAc6wDoWrtLaHRJs5Qg?pwd=kksk</a> 提取码：kksk</strong></p>
</blockquote>
<p>下载好后复制到opencv的文件夹下，如果没有显示的话输入critl+H就可以了。contrib也可以放在这个文件夹下面</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/4ed2bb74aaf545c18d602ca74ede3b84_71bc944cdd274fdf8.png"></p>
<p>创建文件夹并进入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.  mkdir myopencv</span><br><span class="line">    </span><br><span class="line">2.  cd myopencv</span><br><span class="line">    </span><br><span class="line">3.  cmake-gui</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>进入后的c++界面</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/0472a495d99846828b3986bfecc7d8fd_5de0ec3948a74a2b8.png"></p>
<p>&nbsp;点击configure</p>
<p>如果卡在下载ippvc可以自己去下载对应版本的我这里放出我的版本的ippvc</p>
<blockquote>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1C05qBz-eSAUIxdwljce0kw">https://pan.baidu.com/s/1C05qBz-eSAUIxdwljce0kw</a> 密码: 4q33</p>
</blockquote>
<p>&nbsp;然后修改&#x2F;home&#x2F;yuesang&#x2F;software&#x2F;opencv-4.5.5&#x2F;3rdparty&#x2F;ippicv下的ippicv的cmake文件，先把下载好的ippicv放入这个文件夹</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/328ea0150b7542ecbf36430f735ca833_0761ea1ef8544f239.png"></p>
<p>&nbsp;然后编辑ippicv.cmake文件</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/aef7fbdb1238444bb37c4c35289e51a7_46abcd7c861c43c39.png"></p>
<p>这里我把本来的download注释了并且增加了set（res TRUE）</p>
<p>成功后的界面</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/936743654649409f8e917c8de590983f_fffdf7d79f1d4890b.png"></p>
<p>&nbsp;<em><strong>OPENCV_GENERATE_PKGCONFIG这个选项记得要勾起来<br>OpenCV4以上默认不使用pkg-config，该编译选项开启生成opencv4.pc文件，支持pkg-config功能（这个没有勾选的话可能无法配置到clion）</strong></em></p>
<p>去掉这些选项(可以搜索java,python，calib3d把这些包去除)</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/e81eeebba7fc4eafae2eed6ad1855c24_6d47f402ffd449499.png"></p>
<p>&nbsp;<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/1ac8d01495e34fac9162c89a7b607d10_880c16b2825b411fb.png"></p>
<p>&nbsp;<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/227a715872bb4fa78503e5162b302389_827982292f8e4267a.png"></p>
<p>contrib路径的添加**（记得要定位到contib下的modules）**</p>
<p>&nbsp;<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/f65aba7efe2e424285692dc00991a1c8_ccd6e1133b124b56b.png"></p>
<p>直接搜索cuda</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/e3227b17018949fc8fb3a02658b23459_f4c07cd2b00d47c4b.png"></p>
<p>configure完成后</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/82a89c18e4c940f0b4e853bf611b246c_7552b034cf61484b8.png"></p>
<p>再次点击cofigure</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/0d7519cdb7c44bf3b62ee3cacb8b8641_2f29425fc15146fd8.png"></p>
<p>没有报错且变成白色应该就成功了吧然后点击generate生成</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/b69983b5a5f14b3d98edc543b3dd3d2e_3aafc392458744408.png"></p>
<p>&nbsp;进入刚刚创建的文件夹，并且打开终端</p>
<img width="1200" height="507" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/a242254fd7c04137a97c5c2b42f281bb_ec80974e8b4942759.png" class="jop-noMdConv">

<p>&nbsp;输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo make -j20</span><br><span class="line">    </span><br><span class="line">2.  #这个20是你的核心数</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>人生没有一帆风顺出现报错了怎么办</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/640e54d53f744d64b31a6f379f35b343_c7968622ef7f4e058.png"></p>
<p>&nbsp;进入这个页面找到报错的地方把他删掉（就像人生一样要学会合理的放弃）</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/ee76c8de33284ebeb7e988f267ad52a6_4c8ea8dcd4cd40e68.png"></p>
<p>&nbsp;重新配置和生成，然后继续cmake,重复以上操作直到编译成功为止</p>
<p>calib3d和stereo好像是关联的两个包可以取消(这两个包是双目相机标定的好像)</p>
<p>终于完成了真心不容易阿</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/7c8443fb3b1d4b358066e24ad096ebff_f71e0235c8b54bcd8.png"></p>
<p>&nbsp;安装以下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<p>可能会出现这个报错，缺啥我们就给他啥<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/8e9c066d4137478d8c2dcb669d4c1ad4_366f64ce4b8645c99.png"></p>
<p>解压刚刚下载的ippicv进入找到ippicv_lnx</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/6603ed573fc043a882d58f828ce9b93b_be2ce786bb3b439e8.png"></p>
<p>&nbsp;没有这个文件夹我们就建立一个</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/f2928c99636c4b549f0e6db5170ce4d5_4d24900670f4437e8.png"></p>
<p>&nbsp;复制进来</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/1891e85eec6f4852a13d162325ff00ab_387a976ffda043539.png"></p>
<p>重新下载 （大功告成）</p>
<img width="1200" height="748" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/0e53e216feba469da077d32c289d8dc5_d26e2e72753143bab.png" class="jop-noMdConv">

<h3 id="环境变量的配置"><a href="#环境变量的配置" class="headerlink" title=" 环境变量的配置"></a><a href="#"></a> 环境变量的配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/ld.so.conf</span><br></pre></td></tr></table></figure>

<p>输入这两行</p>
<blockquote>
<p>include &#x2F;etc&#x2F;ld.so.conf.d&#x2F;*.conf<br>include &#x2F;usr&#x2F;local&#x2F;lib</p>
</blockquote>
<p>然后再输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo ldconfig</span><br><span class="line">    </span><br><span class="line">2.  sudo gedit /etc/profile   </span><br></pre></td></tr></table></figure>

<p>添加这两行</p>
<blockquote>
<p>#opencv<br>PKG_CONFIG_PATH&#x3D;$PKG_CONFIG_PATH:&#x2F;usr&#x2F;local&#x2F;lib&#x2F;pkgconfig  <br>export PKG_CONFIG_PATH</p>
</blockquote>
<p>然后编译一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h3 id="配置pkg-config环境"><a href="#配置pkg-config环境" class="headerlink" title="配置pkg-config环境"></a><a href="#"></a>配置pkg-config环境</h3><p>opencv4.pc文件的默认路径：&#x2F;usr&#x2F;local&#x2F;lib&#x2F;pkgconfig&#x2F;opencv4.pc<br>若此目录下没有，可以使用以下命令搜索：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo find / -iname opencv4.pc</span><br></pre></td></tr></table></figure>

<p>确实有</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/e80b0db2cdc84671b913554df497433b_1afe6cc0adce45bab.png"></p>
<p>&nbsp;将路径加入到PKG_CONFIG_PATH</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/profile.d/pkgconfig.sh</span><br></pre></td></tr></table></figure>

<p>输入</p>
<blockquote>
<p>export PKG_CONFIG_PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;pkgconfig:$PKG_CONFIG_PATH</p>
</blockquote>
<p>激活一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<p>验证是否成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg-config --libs opencv4</span><br></pre></td></tr></table></figure>

<p>成功啦</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/105397d32dd347458a012ce89866535e_dbfd667b1bff49718.png"></p>
<h3 id="配置动态库环境"><a href="#配置动态库环境" class="headerlink" title=" 配置动态库环境"></a><a href="#"></a> 配置动态库环境</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/ld.so.conf.d/opencv4.conf</span><br></pre></td></tr></table></figure>

<p>加入下面这行</p>
<blockquote>
<p>&#x2F;usr&#x2F;local&#x2F;lib</p>
</blockquote>
<p>生效一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>

<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a><a href="#"></a>测试</h3><p>进入到&#x2F;samples&#x2F;cpp&#x2F;example_cmake下面</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/7edec46e81b942efb251c4c55bc5d9dc_80ff8371a2394b309.png"></p>
<p>打开终端输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake .</span><br></pre></td></tr></table></figure>

<img width="1200" height="737" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/a7e9eb67d22d4560a8fea57410e1440a_0226f308080a40a2b.png" class="jop-noMdConv">

<p>&nbsp;然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make .</span><br></pre></td></tr></table></figure>

<p>应该是成功了</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/0e3c3ed6ed184395a59d87b9a59ae8fd_59857ab2eee7490c9.png"></p>
<p>这个时候我们看一下文件夹下面出现了一个opencv-example</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/3e48d766bf3447c0ace30494fd4f89ee_6b3985a4f64044fb9.png"><br> 运行后出现我人太丑就不放照片了</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/18ecd3fa40b5495895406a508c23bd9d_f4c0eca51cfe498fb.png"></p>
<p>&nbsp;这样opencv的编译到此完成。</p>
<h2 id="三-Clion"><a href="#三-Clion" class="headerlink" title=" 三.Clion"></a><a href="#"></a> 三.Clion</h2><p>创建desktop文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  cd ~/.local/share/applications/</span><br><span class="line">    </span><br><span class="line">2.  sudo gedit Clion.desktop</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意看注释</p>
<blockquote>
<p>[Desktop Entry]<br>Version&#x3D;1.0<br>Terminal&#x3D;false<br>Type&#x3D;Application<br>Name&#x3D;Clion<br>Exec&#x3D;&#x2F;home&#x2F;yuesang&#x2F;software&#x2F;clion-2022.2.1&#x2F;bin&#x2F;clion.sh<br># 注意：Exec表示安装软件的**启动快捷方式**文件路径<br># 注意：Icon表示安装软件的图标路径<br>Icon&#x3D;&#x2F;home&#x2F;yuesang&#x2F;software&#x2F;clion-2022.2.1&#x2F;bin&#x2F;clion.png<br>NoDisplay&#x3D;false<br>StartupWMClass&#x3D;</p>
</blockquote>
<p>接下来是cmakelist的文件编写</p>
<p>这里我放上我的cmakelist</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.23)</span><br><span class="line">project(test)</span><br><span class="line"></span><br><span class="line">find_package(OpenCV REQUIRED) #加这一句</span><br><span class="line">include_directories($&#123;OpenCV_INCLUDE_DIRS&#125;) #加这一句</span><br><span class="line"></span><br><span class="line">set(CMAKE_CXX_STANDARD 14)</span><br><span class="line"></span><br><span class="line">add_executable(test main.cpp)</span><br><span class="line"></span><br><span class="line">target_link_libraries(test $&#123;OpenCV_LIBS&#125;)#加这一句</span><br></pre></td></tr></table></figure>
</blockquote>
<p>测试代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">1.  #include&lt;opencv2/opencv.hpp&gt;</span><br><span class="line">    </span><br><span class="line">2.  #include&lt;iostream&gt;</span><br><span class="line">    </span><br><span class="line">3.  using namespace std;</span><br><span class="line">    </span><br><span class="line">4.  using namespace cv;</span><br><span class="line">    </span><br><span class="line">5.  int main(int argc,char** argv)&#123;</span><br><span class="line">    </span><br><span class="line">6.      Mat src = imread(&quot;/home/yuesang/CLionProjects/test/1.jpg&quot;); //读取图片</span><br><span class="line">    </span><br><span class="line">7.      if (src.empty()) &#123;                     //判断是否找到图片</span><br><span class="line">    </span><br><span class="line">8.          printf(&quot;没有找到图片 &quot;);           //输出文字</span><br><span class="line">    </span><br><span class="line">9.          return -1;</span><br><span class="line">    </span><br><span class="line">10.     &#125;</span><br><span class="line">    </span><br><span class="line">11.     else</span><br><span class="line">    </span><br><span class="line">12.     &#123;</span><br><span class="line">    </span><br><span class="line">13.         namedWindow(&quot;input&quot;,WINDOW_AUTOSIZE);// 显示窗口命名为input ；WINDOW_AUTOSIZE显示大小为图片自定义大小，且不可以更改大小</span><br><span class="line">    </span><br><span class="line">14.         imshow(&quot;input&quot;,src); //显示</span><br><span class="line">    </span><br><span class="line">15.         waitKey(0);//显示的毫秒时间，如果函数参数&lt;=0表示一直显示。&gt;0表示显示的时间</span><br><span class="line">    </span><br><span class="line">16.         destroyAllWindows();</span><br><span class="line">    </span><br><span class="line">17.         return 0;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">19.     &#125;</span><br><span class="line">    </span><br><span class="line">20. &#125;</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>终于配完了</p>
<img width="1200" height="733" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/1f36240ab5a6449d840a1a9f21fe6bd6_308a181b3d5141879.png" class="jop-noMdConv">

<h2 id="四-opencv的卸载"><a href="#四-opencv的卸载" class="headerlink" title="四.opencv的卸载"></a><a href="#"></a>四.opencv的卸载</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo make uninstall</span><br><span class="line">    </span><br><span class="line">2.  cd ..</span><br><span class="line">    </span><br><span class="line">3.  sudo rm -r mybuild</span><br><span class="line">    </span><br><span class="line">4.  sudo rm -r /usr/local/include/opencv2 /usr/local/include/opencv /usr/include/opencv /usr/include/opencv2 /usr/local/share/opencv /usr/local/share/OpenCV /usr/share/opencv /usr/share/OpenCV /usr/local/bin/opencv* /usr/local/lib/libopencv*</span><br><span class="line">    </span><br><span class="line">5.  cd /usr/</span><br><span class="line">    </span><br><span class="line">6.  find . -name &quot;*opencv*&quot; | xargs sudo rm -rf</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>环境变量那块 之前是忘记配置opencv4.pc了所以导致实例可以正常运行但是clion里面运行不了代码，环境变量那块自己也弄得有点迷糊</p>
<p>ubuntu22的坑还是有一些的，比如openvion好像是没办法装到上面因为openvion只支持到20，有什么错误或者不懂的欢迎大家给我指出</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%20pycharm,cuda,cudnn%EF%BC%8Ctensorrt%E7%9A%84%E5%AE%89%E8%A3%85_ubuntu22%20l/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%20pycharm,cuda,cudnn%EF%BC%8Ctensorrt%E7%9A%84%E5%AE%89%E8%A3%85_ubuntu22%20l/" class="post-title-link" itemprop="url">ubuntu22 pycharm,cuda,cudnn，tensorrt的安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 10:37:19 / 修改时间：11:19:10" itemprop="dateCreated datePublished" datetime="2024-01-09T10:37:19+08:00">2024-01-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" itemprop="url" rel="index"><span itemprop="name">环境配置</span></a>
                </span>
            </span>

          
            <span id="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%20pycharm,cuda,cudnn%EF%BC%8Ctensorrt%E7%9A%84%E5%AE%89%E8%A3%85_ubuntu22%20l/" class="post-meta-item leancloud_visitors" data-flag-title="ubuntu22 pycharm,cuda,cudnn，tensorrt的安装" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%20pycharm,cuda,cudnn%EF%BC%8Ctensorrt%E7%9A%84%E5%AE%89%E8%A3%85_ubuntu22%20l/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%20pycharm,cuda,cudnn%EF%BC%8Ctensorrt%E7%9A%84%E5%AE%89%E8%A3%85_ubuntu22%20l/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ubuntu22-pycharm-cuda-cudnn，tensorrt的安装"><a href="#ubuntu22-pycharm-cuda-cudnn，tensorrt的安装" class="headerlink" title="ubuntu22 pycharm,cuda,cudnn，tensorrt的安装"></a>ubuntu22 pycharm,cuda,cudnn，tensorrt的安装</h1><p>（写这篇博客的意义在于之后方便之后重装不用再重新看一大堆博客了）</p>
<p><strong>我的电脑配置为y9000p(2022),12i7,3060的显卡 pycharm版本为2022.2,cuda版本为11.6.2</strong></p>
<p><strong>cudnn版本为8.4.1,tensorrt版本为8.4.1</strong></p>
<h2 id="一-pycharm的安装"><a href="#一-pycharm的安装" class="headerlink" title="一.pycharm的安装"></a><a href="#"></a>一.pycharm的安装</h2><p>官方的安装连接:<a target="_blank" rel="noopener" href="https://www.jetbrains.com/pycharm/download/#section=linux" title="Download PyCharm: Python IDE for Professional Developers by JetBrains">Download PyCharm: Python IDE for Professional Developers by JetBrains</a></p>
<p>下载下来后先不着急可以先把pycharm固定到收藏夹上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  cd ~/.local/share/applications/</span><br><span class="line">    </span><br><span class="line">2.  sudo gedit Pycharm.desktop</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>之后将下方文字复制进去（注意注释!）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1.  [Desktop Entry]</span><br><span class="line">    </span><br><span class="line">2.  Version=1.0</span><br><span class="line">    </span><br><span class="line">3.  Terminal=false</span><br><span class="line">    </span><br><span class="line">4.  Type=Application</span><br><span class="line">    </span><br><span class="line">5.  Name=Pycharm</span><br><span class="line">    </span><br><span class="line">6.  Exec=/opt/pycharm/bin/pycharm.sh</span><br><span class="line">    </span><br><span class="line">7.  # 注意：Exec表示安装软件的**启动快捷方式**文件路径</span><br><span class="line">    </span><br><span class="line">8.  # 注意：Icon表示安装软件的图标路径</span><br><span class="line">    </span><br><span class="line">9.  Icon=/opt/pycharm/bin/pycharm.png</span><br><span class="line">    </span><br><span class="line">10. NoDisplay=false</span><br><span class="line">    </span><br><span class="line">11. StartupWMClass= </span><br></pre></td></tr></table></figure>

<p>之后就可以把pycharm固定到收藏夹上</p>
<h2 id="二-minconda的安装"><a href="#二-minconda的安装" class="headerlink" title="二.minconda的安装"></a><a href="#"></a>二.minconda的安装</h2><p>miniconda安装的时候如果采用sudo则以后使用conda命令需要加sudo</p>
<p>这里选择的是miniconda因为我服务器上面之前配置的也是miniconda为了向服务器看齐，这里的话如果安装的是anconda的话window环境下anconda的env拷贝进来好像是可以直接用的，这个我还没有尝试过。</p>
<p><strong>miniconda的地址：</strong><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/" title="Index of /anaconda/miniconda/ | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror">Index of &#x2F;anaconda&#x2F;miniconda&#x2F; | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a></p>
<p><strong>anconda的地址：</strong><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" title="Index of /anaconda/archive/ | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror">Index of &#x2F;anaconda&#x2F;archive&#x2F; | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a></p>
<p>minconda和anconda的差别就是anconda的base环境包括了conda管理器、Pyhon编译器、常用的包和Spyder IDE等，而miniconda的base环境选择只包括conda管理器和Python编译器</p>
<p>然后选择你下载下来的sh进行安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo bash Miniconda3-py39_4.9.2-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>

<h2 id="三-Nvdia显卡的安装"><a href="#三-Nvdia显卡的安装" class="headerlink" title="三.Nvdia显卡的安装"></a><a href="#"></a>三.Nvdia显卡的安装</h2><p>首先是关于显卡的卸载，我们可以进入附加驱动中选择x.org选项就相当于把本来的显卡驱动删除了，如果你有两个显示屏的话安装完显卡驱动后副屏才可以用因为副屏是挂载在你的独显上</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/6c0b69b61bf14dd6a0b2c3a5d2caefd0_79a070ed217a4622b.png"></p>
<p>&nbsp;显卡安装不建议用附加驱动，因为很慢，所以可以换源后直接用命令行安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ubuntu-drivers devices</span><br></pre></td></tr></table></figure>

<p>这是可用的显卡</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/deedfe2db2f7493d850087f8eb3af135_3bac9215b4b745b7b.png"></p>
<p>&nbsp;<strong>在安装NVIDIA驱动以前需要禁止系统自带显卡驱动nouveau：可以先通过指令<code>lsmod | grep nouveau</code>查看nouveau驱动的启用情况，如果有输出表示nouveau驱动正在工作，如果没有内容输出则表示已经禁用了nouveau</strong>**(这里我没有图所以找了一张网上的)**</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/17c7cfc464b54a90b6fb8e4257c7ca2a_259f95930526495c8.png"></p>
<p>&nbsp;电脑有有输出，表示nouveau启动了，下面进行nouveau的禁用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/modprobe.d/blacklist.conf</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/4107bb0291614f308aa2cfa11b25eb48_bc486b7a284541d48.png"></p>
<p>在blacklist.conf文件末尾加上这两行，并保存：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  blacklist nouveau</span><br><span class="line">    </span><br><span class="line">2.  options nouveau modeset=0</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后在终端中输入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-initramfs -u  #应用更改</span><br></pre></td></tr></table></figure>

<p><strong>选择合适的显卡进行下载（可以进入官网查看cuda和显卡的对应版本:<a target="_blank" rel="noopener" href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html" title="Release Notes :: CUDA Toolkit Documentation">Release Notes :: CUDA Toolkit Documentation</a>）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-driver-510 # 根据自己的n卡可选驱动下载显卡驱动</span><br></pre></td></tr></table></figure>

<p>重启电脑后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi </span><br></pre></td></tr></table></figure>

<p>查看是否安装完成</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/14d411a70a8a496db4597f6b75c2bf16_906040e8175e420aa.png"></p>
<p><strong>（这里有一点需要特别注意：右上角的CUDA Version的意思是你的装的显卡驱动最大支持11.6的cuda）</strong></p>
<h2 id="四：CUDA的安装"><a href="#四：CUDA的安装" class="headerlink" title="四：CUDA的安装"></a><a href="#"></a><strong>四：CUDA的安装</strong></h2><h3 id="CUDA下载"><a href="#CUDA下载" class="headerlink" title="CUDA下载"></a><a href="#"></a><strong>CUDA下载</strong></h3><p>我们进入<a target="_blank" rel="noopener" href="https://developer.nvidia.cn/cuda-toolkit-archive" title="CUDA Toolkit Archive | NVIDIA Developer">CUDA Toolkit Archive | NVIDIA Developer</a>选择我们适合的cuda这里我选择11.6.2版本的</p>
<img width="1200" height="654" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/472f848107ea4535bd4249ef515ebcb4_5c8286c7ed0b46989.png" class="jop-noMdConv">

<p>&nbsp;安装的命令如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  wget https://developer.download.nvidia.com/compute/cuda/11.6.2/local_installers/cuda_11.6.2_510.47.03_linux.run</span><br><span class="line">    </span><br><span class="line">2.  sudo sh cuda_11.6.2_510.47.03_linux.run</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>细节的地方来了，你的tmp空间可能不够你可以在你的home文件夹下建立一个tmp然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  wget https://developer.download.nvidia.com/compute/cuda/11.6.2/local_installers/cuda_11.6.2_510.47.03_linux.run</span><br><span class="line">    </span><br><span class="line">2.  sudo sh cuda_11.6.2_510.47.03_linux.run --tmpdir=这里填写你的新建立的tmp位置</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用完以后删掉这个tmp即可因为tmp文件夹重启后里面的文件默认不保存</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/7b9eaf1e05594a15ab45ae4ccfd5b97b_12b269e7bf4445879.png"></p>
<p>等待一会这个时间可能会有点长</p>
<p>选择continue</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/c33c5596287f4f7e99b292b501636093_b631af5dcf9e426b9.png"> 输入accept</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/be2fd1ea55654298a1e054707fa019c2_1390615b7701418d8.png"></p>
<p>&nbsp;因为刚开始我们已经安装完驱动所以这里可以不用选择（之前安装的时候出现了一个小问题就是我当初重装显卡驱动的时候把显卡驱动删了想着能不能用run里面自带的但是我是没有成功，之后用下面这个方法也同样成功运行）</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/cdc3b1056f874696b16b61351371eb6e_842dcbddc6794f779.png"></p>
<h3 id="配置cuda环境"><a href="#配置cuda环境" class="headerlink" title="配置cuda环境"></a><a href="#"></a><strong>配置cuda环境</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>添加以下到末尾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.  export PATH=$PATH:/usr/local/cuda/bin  </span><br><span class="line">    </span><br><span class="line">2.  export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda/lib64  </span><br><span class="line">    </span><br><span class="line">3.  export LIBRARY_PATH=$LIBRARY_PATH:/usr/local/cuda/lib64</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>在终端输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -V</span><br></pre></td></tr></table></figure>

<p>显示以下则为成功（记得V要大写）</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/7dc6f3364ff94039ace3ef3ffc66113b_92618f1fc8ac48ed9.png"></p>
<p><strong>如果不成功，重新source ~&#x2F;.bashrc然后输入nvcc -V成功的话，细节的地方来了！！！！！</strong></p>
<p><strong>首先，我们需要搞明白Linux启动时读取配置文件的顺序。在刚登录Linux时，首先启动<code>/etc/profile</code> 文件，然后再启动用户目录下的 <code>~/.bash_profile</code>、<code>~/.bash_login</code>或 <code>~/.profile</code>文件中的其中一个，<br>执行的顺序为：<code>~/.bash_profile</code>、<code>~/.bash_login</code>、 <code>~/.profile</code></strong></p>
<p><code>所以如果行不同我们可以：</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/profile</span><br></pre></td></tr></table></figure>

<p>然后输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.  export PATH=$PATH:/usr/local/cuda/bin  </span><br><span class="line">    </span><br><span class="line">2.  export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda/lib64  </span><br><span class="line">    </span><br><span class="line">3.  export LIBRARY_PATH=$LIBRARY_PATH:/usr/local/cuda/lib64</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<p>之后应该就能显示了</p>
<h3 id="CUDA的测试"><a href="#CUDA的测试" class="headerlink" title="CUDA的测试"></a><a href="#"></a>CUDA的测试</h3><p>下载测试文件：<a target="_blank" rel="noopener" href="https://github.com/nvidia/cuda-samples" title="GitHub - NVIDIA/cuda-samples: Samples for CUDA Developers which demonstrates features in CUDA Toolkit">GitHub - NVIDIA&#x2F;cuda-samples: Samples for CUDA Developers which demonstrates features in CUDA Toolkit</a></p>
<p>下载解压后make一下</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/5c812c23a6ee4fd69748eb91a128dc05_39a5e78576a14f1ca.png"></p>
<p>&nbsp;<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/5ea6dfd19d964fa9ac7b7f95183dbf1d_1475ea4225a84c158.png"></p>
<p>&nbsp;<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/a6886047066744b08e2fa1cfc9af2df0_63d7e9f5fdd8445bb.png"></p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/b54f4a317fc64aa795e66bf71163d97e_d0876e270e6e47f28.png"></p>
<p>出现这个结果就是成功了</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/4373d4bbf57445989e5004d3bd6ad751_cd458d6cee7a44d79.png"></p>
<h2 id="四-CUDANN的安装"><a href="#四-CUDANN的安装" class="headerlink" title="四.CUDANN的安装"></a><a href="#"></a>四.CUDANN的安装</h2><h3 id="CUDANN下载"><a href="#CUDANN下载" class="headerlink" title="CUDANN下载"></a><a href="#"></a>CUDANN下载</h3><p>下载连接：<a target="_blank" rel="noopener" href="https://developer.nvidia.com/rdp/cudnn-download">https://developer.nvidia.com/rdp/cudnn-download</a></p>
<p>这里我下在的是cudann8.4.1</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/9f24be3dde60443f9a18839b76218bdb_6e701b31e177461eb.png"></p>
<p>&nbsp;下载Linux x86-64(tar)</p>
<p>进入解压后的界面，然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo cp cudnn-*-archive/include/cudnn*.h /usr/local/cuda-11.6/include </span><br><span class="line">    </span><br><span class="line">2.  sudo cp -P cudnn-*-archive/lib/libcudnn* /usr/local/cuda-11.6/lib64 </span><br><span class="line">    </span><br><span class="line">3.  sudo chmod a+r /usr/local/cuda-11.6/include/cudnn*.h /usr/local/cuda-11.6/lib64/libcudnn*</span><br><span class="line">    </span><br><span class="line">4.  #下面这个是方便后面opencv配置cuda</span><br><span class="line">    </span><br><span class="line">5.  sudo cp cudnn-*-archive/include/cudnn*.h /usr/local/cuda/include </span><br><span class="line">    </span><br><span class="line">6.  sudo cp -P cudnn-*-archive/lib/libcudnn* /usr/local/cuda/lib64 </span><br><span class="line">    </span><br><span class="line">7.  sudo chmod a+r /usr/local/cuda-11.6/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>之后查看<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=CUDNN&spm=1001.2101.3001.7020">CUDNN</a>版本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/local/cuda-11.6/include/cudnn_version.h | grep CUDNN_MAJOR -A 2</span><br></pre></td></tr></table></figure>

<h3 id="CUDNN依赖"><a href="#CUDNN依赖" class="headerlink" title="CUDNN依赖"></a><a href="#"></a>CUDNN依赖</h3><p>依赖网站：<a target="_blank" rel="noopener" href="https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2004/x86_64/" title="Index of /compute/cuda/repos/ubuntu2004/x86_64">Index of &#x2F;compute&#x2F;cuda&#x2F;repos&#x2F;ubuntu2004&#x2F;x86_64</a></p>
<p>找到对应的依赖（一个带dev一个不带）</p>
<p>或者使用命令行进行下载</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.  wget https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2004/x86_64/libcudnn8_8.4.1.50-1+cuda11.6_amd64.deb</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">3.  wget https://developer.download.nvidia.cn/compute/cuda/repos/ubuntu2004/x86_64/libcudnn8-dev_8.4.1.50-1+cuda11.6_amd64.deb </span><br></pre></td></tr></table></figure>

<p>安装依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo dpkg -i libcudnn8_8.4.1.50-1+cuda11.6_amd64.deb </span><br><span class="line">    </span><br><span class="line">2.  sudo dpkg -i libcudnn8-dev_8.4.1.50-1+cuda11.6_amd64.deb </span><br></pre></td></tr></table></figure>

<h2 id="五-Tensortrt的安装"><a href="#五-Tensortrt的安装" class="headerlink" title="五.Tensortrt的安装"></a><a href="#"></a>五.Tensortrt的安装</h2><h3 id="1-下载"><a href="#1-下载" class="headerlink" title="1.下载"></a><a href="#"></a>1.下载</h3><p>这里是tensorrt的下载连接:<a target="_blank" rel="noopener" href="https://developer.nvidia.com/nvidia-tensorrt-8x-download">https://developer.nvidia.com/nvidia-tensorrt-8x-download</a></p>
<p>下载tar包解压后的到的连接</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/0e435b363bc446c886e43e5b21292e23_54c963cc1b2a438ab.png"></p>
<p>修改环境变量:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.  sudo gedit ~/.bashrc </span><br></pre></td></tr></table></figure>

<p>在文件末尾加入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.  export LD_LIBRARY_PATH=$LD_LIBRARY_PATH：/home/stand/Software/TensorRT-8.4.1.5/lib </span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<h3 id="2-测试样例"><a href="#2-测试样例" class="headerlink" title="2. 测试样例"></a><a href="#"></a>2. 测试样例</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.  cd TensorRT-8.4.1.5/samples/sampleMNIST</span><br><span class="line">    </span><br><span class="line">2.  make -j16</span><br><span class="line">    </span><br><span class="line">3.  cd ../../bin/</span><br><span class="line">    </span><br><span class="line">4.  ./sample_mnist</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样就成功了</p>
<img width="1200" height="1242" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/3eb8c7cdcede4fdead0f60fb785bad68_4fb7033780c548148.png" class="jop-noMdConv">

<h3 id="3-python部分的安装"><a href="#3-python部分的安装" class="headerlink" title="3.python部分的安装"></a><a href="#"></a>3.python部分的安装</h3><p>用miniconda创建完环境之后</p>
<p>直接pip目录中的uff，python(注意选择和你conda创建python的版本相对应) ，graphsurgeon下的whl就可以了</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/5fdfb1069d5c433781f5f8abf04410eb_48a6f8c2ba974c2db.png"></p>
<p>我这里是一次就成功了可能出现问题的话可以参考这位大佬:<a target="_blank" rel="noopener" href="https://blog.csdn.net/lilin020401/article/details/126475351#t4" title="Ubuntu22.04 下安装驱动、CUDA、cudnn以及TensorRT_lilin020401的博客-CSDN博客">Ubuntu22.04 下安装驱动、CUDA、cudnn以及TensorRT_lilin020401的博客-CSDN博客</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/09/Openvino/Ubuntu19%20Openvion%20cmake%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91_cmake%20%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAopenvino%E9%A1%B9%E7%9B%AE-C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/Openvino/Ubuntu19%20Openvion%20cmake%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91_cmake%20%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAopenvino%E9%A1%B9%E7%9B%AE-C/" class="post-title-link" itemprop="url">Ubuntu19 Openvion cmake源码编译</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 10:37:19 / 修改时间：11:16:39" itemprop="dateCreated datePublished" datetime="2024-01-09T10:37:19+08:00">2024-01-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" itemprop="url" rel="index"><span itemprop="name">环境配置</span></a>
                </span>
            </span>

          
            <span id="/2024/01/09/Openvino/Ubuntu19%20Openvion%20cmake%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91_cmake%20%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAopenvino%E9%A1%B9%E7%9B%AE-C/" class="post-meta-item leancloud_visitors" data-flag-title="Ubuntu19 Openvion cmake源码编译" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/09/Openvino/Ubuntu19%20Openvion%20cmake%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91_cmake%20%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAopenvino%E9%A1%B9%E7%9B%AE-C/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/09/Openvino/Ubuntu19%20Openvion%20cmake%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91_cmake%20%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAopenvino%E9%A1%B9%E7%9B%AE-C/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Ubuntu19-Openvion-cmake源码编译"><a href="#Ubuntu19-Openvion-cmake源码编译" class="headerlink" title="Ubuntu19 Openvion cmake源码编译"></a>Ubuntu19 Openvion cmake源码编译</h1><p>苦逼打工人<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Ubuntu&spm=1001.2101.3001.7020">Ubuntu</a>服务器没有可视化界面，而且服务器用的是Ubuntu19，官网好像只支持18，20的安装，没办法为了量化这些模型只好cmake编译了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  git clone https://github.com/openvinotoolkit/openvino.git</span><br><span class="line">    </span><br><span class="line">2.  cd openvino</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解压后的结构目录</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/5a8d3ae6a20e40e6b93287e96f8e8a34_2e068f8ccd0e4123a.png"></p>
<p>有的包需要我们去github下载但是公司的机子不能科学上网但是Openvino官方提供了人性的gitee安装的脚本。进入Openvino的目录之后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  chmod +x scripts/submodule_update_with_gitee.sh</span><br><span class="line">    </span><br><span class="line">2.  ./scripts/submodule_update_with_gitee.sh</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后安装外部依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.  chmod +x install_build_dependencies.sh</span><br><span class="line">    </span><br><span class="line">2.  sudo ./install_build_dependencies.sh</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后可以开始狗蛋的cmake编译了，先用这个试试水</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  1.    cmake -DCMAKE_BUILD_TYPE=Release ..</span><br><span class="line">    </span><br><span class="line">2.    make --jobs=$(nproc --all)</span><br></pre></td></tr></table></figure>

<p>我中间报了一些黄的的警告我没有管他之后</p>
<p><strong>（python版的openvino好像可以直接pip 安装runtime或者dev包括了onnx转ir的mo_onnx，但是如果要做int8量化的话最好还是编译一下）（记得换成你的python版本）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.  #根据自己实际需要我这里需要用到python版本的openvino我才安装的</span><br><span class="line">    </span><br><span class="line">2.  #如果需要的话可以指定一下位置</span><br><span class="line">    </span><br><span class="line">3.  cmake -DCMAKE_BUILD_TYPE=Release -DNGRAPH_DEBUG_ENABLE=ON \</span><br><span class="line">    </span><br><span class="line">4.  -DENABLE_PYTHON=ON \</span><br><span class="line">    </span><br><span class="line">5.  -DPYTHON_EXECUTABLE=/usr/bin/python3.7 \</span><br><span class="line">    </span><br><span class="line">6.  -DPYTHON_LIBRARY=/usr/lib/x86_64-linux-gnu/libpython3.7m.so \</span><br><span class="line">    </span><br><span class="line">7.  -DPYTHON_INCLUDE_DIR=/usr/include/python3.7 ..   </span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/3d3dcc4c683d494682cdff4c2684d517_87712abb6a8444b2b.png"></p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/ecdd776fdfc44f8d9971b5176ad620f8_f2483488a09e40d78.png"></p>
<p>&nbsp;没有报错就好，然后开始编译库</p>
<p>&nbsp;<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/359aefa8233449278ae14e7ab0bb1925_e133f89b69294f79a.png"></p>
<p>我编译的过程很顺利没有出现什么其他的错误，编译完以后直接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<p>&nbsp;之后就可以快乐的使用Openvino啦</p>
<p><strong>(经过我测试，我发现如果有python使用需求的小伙伴们可以直接从官网pip下载OpenVino里面的东西有mo.py的转换还有int8模型量化的代码)</strong></p>
<p>最近还是int8试试水，之后如果可以出一期Openvino量化的教程。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/09/Openvino/Openvino%E9%87%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%20Fp32%20Fp16%20int8_openvino%20int8-CSDN%E5%8D%9A%E5%AE%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/Openvino/Openvino%E9%87%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%20Fp32%20Fp16%20int8_openvino%20int8-CSDN%E5%8D%9A%E5%AE%A2/" class="post-title-link" itemprop="url">Openvino量化模型推理 Fp32 Fp16 int8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 10:37:19 / 修改时间：11:16:34" itemprop="dateCreated datePublished" datetime="2024-01-09T10:37:19+08:00">2024-01-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" itemprop="url" rel="index"><span itemprop="name">环境配置</span></a>
                </span>
            </span>

          
            <span id="/2024/01/09/Openvino/Openvino%E9%87%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%20Fp32%20Fp16%20int8_openvino%20int8-CSDN%E5%8D%9A%E5%AE%A2/" class="post-meta-item leancloud_visitors" data-flag-title="Openvino量化模型推理 Fp32 Fp16 int8" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/09/Openvino/Openvino%E9%87%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%20Fp32%20Fp16%20int8_openvino%20int8-CSDN%E5%8D%9A%E5%AE%A2/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/09/Openvino/Openvino%E9%87%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%20Fp32%20Fp16%20int8_openvino%20int8-CSDN%E5%8D%9A%E5%AE%A2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Openvino量化模型推理-Fp32-Fp16-int8"><a href="#Openvino量化模型推理-Fp32-Fp16-int8" class="headerlink" title="Openvino量化模型推理 Fp32 Fp16 int8"></a>Openvino量化模型推理 Fp32 Fp16 int8</h1><p>我忘记我是哪个版本的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=openvino&spm=1001.2101.3001.7020">openvino</a>了，这里记录一下我将模型从onnx转换到Openvino的Ir模型以及最后的int8,Openvino比Tensorrt的泛化性要高，Tensorrt的量化是模型放到不同的机子上面都需要重新量化一次但是Openvino没有这个缺点。</p>
<p>我的OpenVino采用的是源码编译的这里采用的是python代码，之后可能会写一份C++代码放上去,先上才艺</p>
<h2 id="一-将模型转换成onnx模型"><a href="#一-将模型转换成onnx模型" class="headerlink" title="一.将模型转换成onnx模型"></a><a href="#"></a>一.将模型转换成<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=onnx%E6%A8%A1%E5%9E%8B&spm=1001.2101.3001.7020">onnx模型</a></h2><p>这里我采用的是pytorch模型文件转成onnx</p>
<p>模型结构包括参数保存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">1.  import torch</span><br><span class="line">    </span><br><span class="line">2.  import torch.nn</span><br><span class="line">    </span><br><span class="line">3.  import os</span><br><span class="line">    </span><br><span class="line">4.  import sys</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">7.  def export(model_path):</span><br><span class="line">    </span><br><span class="line">8.      net = torch.load(</span><br><span class="line">    </span><br><span class="line">9.          model_path,</span><br><span class="line">    </span><br><span class="line">10.         map_location=torch.device(&#x27;cpu&#x27;),</span><br><span class="line">    </span><br><span class="line">11.     )</span><br><span class="line">    </span><br><span class="line">12.     net.eval()</span><br><span class="line">    </span><br><span class="line">13.     #这里需要指定你输入和输出的名字方便后面推理</span><br><span class="line">    </span><br><span class="line">14.     input_names = [&#x27;input&#x27;]</span><br><span class="line">    </span><br><span class="line">15.     output_names = [&#x27;output&#x27;]</span><br><span class="line">    </span><br><span class="line">16.     #这里需要确定模型的输入</span><br><span class="line">    </span><br><span class="line">17.     x = torch.randn(1, 3, 224, 224)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">19.     torch.onnx.export(</span><br><span class="line">    </span><br><span class="line">20.         net,</span><br><span class="line">    </span><br><span class="line">21.         x,</span><br><span class="line">    </span><br><span class="line">22.         os.path.join(</span><br><span class="line">    </span><br><span class="line">23.             os.path.split(model_path)[0],</span><br><span class="line">    </span><br><span class="line">24.             &#x27;best.onnx&#x27;,</span><br><span class="line">    </span><br><span class="line">25.         ),</span><br><span class="line">    </span><br><span class="line">26.         input_names=input_names,</span><br><span class="line">    </span><br><span class="line">27.         output_names=output_names,</span><br><span class="line">    </span><br><span class="line">28.         verbose=False,</span><br><span class="line">    </span><br><span class="line">29.         opset_version=12,</span><br><span class="line">    </span><br><span class="line">30.     )</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">33. if __name__ == &quot;__main__&quot;:</span><br><span class="line">    </span><br><span class="line">34.     model_path = &#x27;/home/yuesang/Pythonproject/MobileNetV3/runs/train/exp1/best.pt&#x27;</span><br><span class="line">    </span><br><span class="line">35.     export(model_path)</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>模型采用字典保存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">1.  import os</span><br><span class="line">    </span><br><span class="line">2.  import torch</span><br><span class="line">    </span><br><span class="line">3.  from swin_transformer import *</span><br><span class="line">    </span><br><span class="line">4.  from collections import OrderedDict</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">6.  DROP_PATH_RATE = 0.5</span><br><span class="line">    </span><br><span class="line">7.  EMBED_DIM = 192</span><br><span class="line">    </span><br><span class="line">8.  DEPTHS = [2, 2, 18, 2]</span><br><span class="line">    </span><br><span class="line">9.  NUM_HEADS = [6, 12, 24, 48]</span><br><span class="line">    </span><br><span class="line">10. WINDOW_SIZE = 7</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">12. model_path = &#x27;&#x27;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">14. checkpoint = torch.load(</span><br><span class="line">    </span><br><span class="line">15.     model_path,</span><br><span class="line">    </span><br><span class="line">16.     map_location=&#x27;cpu&#x27;,</span><br><span class="line">    </span><br><span class="line">17. )</span><br><span class="line">    </span><br><span class="line">18. model = SwinTransformer(</span><br><span class="line">    </span><br><span class="line">19.     img_size=224,</span><br><span class="line">    </span><br><span class="line">20.     patch_size=4,</span><br><span class="line">    </span><br><span class="line">21.     in_chans=3,</span><br><span class="line">    </span><br><span class="line">22.     num_classes=0,</span><br><span class="line">    </span><br><span class="line">23.     embed_dim=EMBED_DIM,</span><br><span class="line">    </span><br><span class="line">24.     depths=DEPTHS,</span><br><span class="line">    </span><br><span class="line">25.     num_heads=NUM_HEADS,</span><br><span class="line">    </span><br><span class="line">26.     window_size=WINDOW_SIZE,</span><br><span class="line">    </span><br><span class="line">27.     mlp_ratio=4,</span><br><span class="line">    </span><br><span class="line">28.     qkv_bias=True,</span><br><span class="line">    </span><br><span class="line">29.     qk_scale=None,</span><br><span class="line">    </span><br><span class="line">30.     drop_rate=0.0,</span><br><span class="line">    </span><br><span class="line">31.     drop_path_rate=DROP_PATH_RATE,</span><br><span class="line">    </span><br><span class="line">32.     ape=False,</span><br><span class="line">    </span><br><span class="line">33.     patch_norm=True,</span><br><span class="line">    </span><br><span class="line">34. )</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">36. new_state_dict = OrderedDict()</span><br><span class="line">    </span><br><span class="line">37. for k, v in checkpoint[&#x27;model&#x27;].items():</span><br><span class="line">    </span><br><span class="line">38.     if k != &#x27;head.weight&#x27;:</span><br><span class="line">    </span><br><span class="line">39.         new_state_dict[k] = v</span><br><span class="line">    </span><br><span class="line">40.     else:</span><br><span class="line">    </span><br><span class="line">41.         print(k, v.shape)</span><br><span class="line">    </span><br><span class="line">42. model.load_state_dict(new_state_dict, strict=False)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">44. model.eval()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">46. input_names = [&#x27;input&#x27;]</span><br><span class="line">    </span><br><span class="line">47. output_names = [&#x27;output&#x27;]</span><br><span class="line">    </span><br><span class="line">48. x = torch.randn(1, 3, 224, 224)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">50. torch.onnx.export(</span><br><span class="line">    </span><br><span class="line">51.     model,</span><br><span class="line">    </span><br><span class="line">52.     x,</span><br><span class="line">    </span><br><span class="line">53.     os.path.join(</span><br><span class="line">    </span><br><span class="line">54.         os.path.split(model_path)[0],</span><br><span class="line">    </span><br><span class="line">55.         &#x27;best.onnx&#x27;,</span><br><span class="line">    </span><br><span class="line">56.     ),</span><br><span class="line">    </span><br><span class="line">57.     input_names=input_names,</span><br><span class="line">    </span><br><span class="line">58.     output_names=output_names,</span><br><span class="line">    </span><br><span class="line">59.     verbose=False,</span><br><span class="line">    </span><br><span class="line">60.     opset_version=12,</span><br><span class="line">    </span><br><span class="line">61. )</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>总结来说就是把字典导入到模型的结构里面然后在进行onnx的转换这部分可以自己网上找找教程听多的</p>
<h2 id="二-模型从onnx模型转ir模型"><a href="#二-模型从onnx模型转ir模型" class="headerlink" title="二.模型从onnx模型转ir模型"></a><a href="#"></a>二.模型从onnx模型转ir模型</h2><p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/397c40c6ae4a4094a2e8dc88cda85f48_cbd8964035d941349.png"></p>
<p>&nbsp;这里如果你是用python直接pip的话可以直接进入conda的环境去使用她，如果你是源码编译OpenVino的话可能要进入那个目录下载一下，这里我个人觉得如果你只是用来测试的话Python其实就很够用了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python mo_onnx.py --input_model &lt;输入模型路经&gt; --output_dir &lt;输出模型路经&gt;</span><br></pre></td></tr></table></figure>

<p><strong>（如果需要量化到FP16的话需要额外指定参数 –compress_to_fp16）</strong></p>
<p>首先先将你的模型转换到Ir格式，这里放一下mo的参数你们可以有道翻译一下我个人英语不太好这里就不解释了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.  mo -h #可以查看mo的参数</span><br><span class="line">    </span><br><span class="line">2.  #或者是进入到mo.py所在的文件夹然后</span><br><span class="line">    </span><br><span class="line">3.  python mo.py -h</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&nbsp;之后测试一下转换完的模型推理速度</p>
<p>进入Openvino这个文件夹</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/41d7baf4604c49d39d32700025ce258a_3e8eadeb2477454a9.png"></p>
<p>&nbsp;然后查看一下你模型量化的结果（FP32）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python ./benchmark_app.py -m &lt;量化后的xml文件&gt; -d CPU -api async -i &lt;选择图片路径&gt; -b 1</span><br></pre></td></tr></table></figure>

<p>其中 <strong>-d</strong>指定的是你的设备 -api指定的是你的推理模式（同步还是异步推理）</p>
<p>看一下FP32模型的速度</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/9dbc17d300f143568c3c598f768cc605_dbe4da939502499a9.png"></p>
<p>&nbsp;FP16</p>
<img width="598" height="240" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/bec68d6b955a4401bedf8d1c54e700c6_f4b0436799124d78a.png" class="jop-noMdConv">

<p>&nbsp;ONNX模型推理速度</p>
<img width="870" height="240" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/c25101469a364d8e9d8bea60f3dd3142_2ded076e1fd74ad0b.png" class="jop-noMdConv">

<h2 id="三，Int8量化"><a href="#三，Int8量化" class="headerlink" title=" 三，Int8量化"></a><a href="#"></a> 三，<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Int8&spm=1001.2101.3001.7020">Int8</a>量化</h2><p>在转换之前，我们需要准备一下数据（在量化过程中会使用到）。对于自己的数据集首先转换成openvino支持的数据格式，这里使用imagenet数据集格式，对于分类任务需要annotation.txt文件以及labels.txt共两个文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.  ├── dataset:： 存放数据集的根目录</span><br><span class="line">    </span><br><span class="line">2.  │     ├── 1：         </span><br><span class="line">    </span><br><span class="line">3.  │     ├── 2：     </span><br><span class="line">    </span><br><span class="line">4.  │     ├── 3：         </span><br><span class="line">    </span><br><span class="line">5.  │     ├── 4：    </span><br><span class="line">    </span><br><span class="line">6.  │     └── .... ：       </span><br></pre></td></tr></table></figure>

<p>这里给一个生成annotation.txt和labels.txt脚本（霹雳趴拉导师那边抄的）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">1.  import os</span><br><span class="line">    </span><br><span class="line">2.  import glob</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">4.  image_dir = &quot;/your_dataset_dir&quot;</span><br><span class="line">    </span><br><span class="line">5.  assert os.path.exists(image_dir), &quot;image dir does not exist...&quot;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">7.  img_list = glob.glob(os.path.join(image_dir, &quot;*&quot;, &quot;*.jpg&quot;))</span><br><span class="line">    </span><br><span class="line">8.  assert len(img_list) &gt; 0, &quot;No images(.jpg) were found in image dir...&quot;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">10. classes_info = os.listdir(image_dir)</span><br><span class="line">    </span><br><span class="line">11. classes_info.sort()</span><br><span class="line">    </span><br><span class="line">12. classes_dict = &#123;&#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">14. # create label file</span><br><span class="line">    </span><br><span class="line">15. with open(&quot;my_labels.txt&quot;, &quot;w&quot;) as lw:</span><br><span class="line">    </span><br><span class="line">16.     # 注意，没有背景时，index要从0开始</span><br><span class="line">    </span><br><span class="line">17.     for index, c in enumerate(classes_info, start=0):</span><br><span class="line">    </span><br><span class="line">18.         txt = &quot;&#123;&#125;:&#123;&#125;&quot;.format(index, c)</span><br><span class="line">    </span><br><span class="line">19.         if index != len(classes_info):</span><br><span class="line">    </span><br><span class="line">20.             txt += &quot;\n&quot;</span><br><span class="line">    </span><br><span class="line">21.         lw.write(txt)</span><br><span class="line">    </span><br><span class="line">22.         classes_dict.update(&#123;c: str(index)&#125;)</span><br><span class="line">    </span><br><span class="line">23. print(&quot;create my_labels.txt successful...&quot;)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">25. # create annotation file</span><br><span class="line">    </span><br><span class="line">26. with open(&quot;my_annotation.txt&quot;, &quot;w&quot;) as aw:</span><br><span class="line">    </span><br><span class="line">27.     for img in img_list:</span><br><span class="line">    </span><br><span class="line">28.         img_classes = classes_dict[img.split(&quot;/&quot;)[-2]]</span><br><span class="line">    </span><br><span class="line">29.         txt = &quot;&#123;&#125; &#123;&#125;&quot;.format(img, img_classes)</span><br><span class="line">    </span><br><span class="line">30.         if index != len(img_list):</span><br><span class="line">    </span><br><span class="line">31.             txt += &quot;\n&quot;</span><br><span class="line">    </span><br><span class="line">32.         aw.write(txt)</span><br><span class="line">    </span><br><span class="line">33. print(&quot;create my_annotation.txt successful...&quot;)</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-1-模型测试"><a href="#3-1-模型测试" class="headerlink" title="3.1 模型测试"></a><a href="#"></a>3.1 模型测试</h3><p>首先先测试FP32和FP16的模型精度，先准备一份yaml文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">1.  models:</span><br><span class="line">    </span><br><span class="line">2.   - name: mobileNetV3Fp32</span><br><span class="line">    </span><br><span class="line">3.      launchers:</span><br><span class="line">    </span><br><span class="line">4.        #下面指定运行的框架 dlsdk就是openvino， 也可以是tensorflow或者其他框架</span><br><span class="line">    </span><br><span class="line">5.        #model/weights是要测试的模型文件名</span><br><span class="line">    </span><br><span class="line">6.        #adapter是告诉accuracy checker模型的输出是目标分类还是目标识别或者其他的输出</span><br><span class="line">    </span><br><span class="line">7.       - framework: openvino</span><br><span class="line">    </span><br><span class="line">8.          model: /home/yuesang/Pythonproject/MobileNetV3/runs/train/exp1/bestfp16.xml</span><br><span class="line">    </span><br><span class="line">9.          weights: /home/yuesang/Pythonproject/MobileNetV3/runs/train/exp1/bestfp16.bin</span><br><span class="line">    </span><br><span class="line">10.         adapter: classification</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">12.     datasets:</span><br><span class="line">    </span><br><span class="line">13.       #下面这部分是有关数据集的路径，数据集的格式(imagenet，VOC或者其他)以及标注文件的名字</span><br><span class="line">    </span><br><span class="line">14.      - name: Flower</span><br><span class="line">    </span><br><span class="line">15.         data_source: /mnt/hdd-4t/data/hanyue/mobileNet/flower</span><br><span class="line">    </span><br><span class="line">16.         annotation_conversion:</span><br><span class="line">    </span><br><span class="line">17.           converter: imagenet</span><br><span class="line">    </span><br><span class="line">18.           annotation_file: &quot;/home/yuesang/Pythonproject/MobileNetV3/onnxinference/int8inference/my_annotation.txt&quot;</span><br><span class="line">    </span><br><span class="line">19.         #预处理告诉ac_checker工具在把数据集图片送进模型前要做那些预处理，比如缩放，剪切或者调整RGB/BGR顺序之类</span><br><span class="line">    </span><br><span class="line">20.         reader: opencv_imread # default setting</span><br><span class="line">    </span><br><span class="line">21.         preprocessing:</span><br><span class="line">    </span><br><span class="line">22.          - type: resize</span><br><span class="line">    </span><br><span class="line">23.             size: 256</span><br><span class="line">    </span><br><span class="line">24.             aspect_ratio_scale: greater</span><br><span class="line">    </span><br><span class="line">25.          - type: crop</span><br><span class="line">    </span><br><span class="line">26.             size: 224</span><br><span class="line">    </span><br><span class="line">27.          - type: bgr_to_rgb # bgr format in opencv</span><br><span class="line">    </span><br><span class="line">28.          - type: normalization</span><br><span class="line">    </span><br><span class="line">29.             # you may specify precomputed statistics manually or use precomputed values, such as ImageNet as well</span><br><span class="line">    </span><br><span class="line">30.             mean: (123.675, 116.28, 103.53)</span><br><span class="line">    </span><br><span class="line">31.             std: (58.395, 57.12, 57.375)</span><br><span class="line">    </span><br><span class="line">32.         #这里定义统计准确度用的算法，这里要看2种准确度，一���是top1的，还一个是top5的</span><br><span class="line">    </span><br><span class="line">33.         metrics:</span><br><span class="line">    </span><br><span class="line">34.          - name: accuracy @ top1</span><br><span class="line">    </span><br><span class="line">35.             type: accuracy</span><br><span class="line">    </span><br><span class="line">36.             top_k: 1</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>model：存放你的xml的路径，在精度测试中可以先不用放weight,这个model也可以是你的onnx文件</p>
<p>adapter:选择你的网络类型我这里是分类网络，openvino还支持目标检测网络具体可以看看config下面的配置</p>
<p>datasource:下面存放的是你的数据集的根路径（这里有个坑就是这个文件夹下面存放的图片路径要和你上面生成的annotion.txt对应起来包括你的类别还有路径，相当于就是你把你数据集所有的图片全部放在这个路径下面，验证的时候由annotion.txt里面的东西验证）</p>
<p>convert:我直接写imagenet没有什么影响</p>
<p>preprocessing：里面的是写的是你预处理操作（记得颜色通道的转换不然的话精确度一直和训练的时候验证都是错的）这里有的预处理很傻逼我官网也没有找到如果有人找到的话欢迎评论区和我说一声哈哈哈哈哈</p>
<p>&nbsp;metrics:定义的是评价指标这里是分类网络所以我采用的是accuary这里的top1表示，评分排名前1中能正确分出的概率。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accuracy_check -c 你的yaml文件 -s ./ -td CPU</span><br></pre></td></tr></table></figure>

<p>可以得到正确率了，之后int8量化也需要用到这个进行评估。</p>
<h3 id="3-2-yaml文件以及json文件的准备"><a href="#3-2-yaml文件以及json文件的准备" class="headerlink" title="3.2.yaml文件以及json文件的准备"></a><a href="#"></a>3.2.yaml文件以及json文件的准备</h3><p>这里int8有两种量化方式一种是全int8量化还有一种是混精度量化首先先准备一下model.yaml文件</p>
<p>这里的yaml文件和刚刚那个yaml文件大差不差</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">1.  models:</span><br><span class="line">    </span><br><span class="line">2.   - name: mobileNetV3</span><br><span class="line">    </span><br><span class="line">3.      launchers:</span><br><span class="line">    </span><br><span class="line">4.       - framework: dlsdk</span><br><span class="line">    </span><br><span class="line">5.          device: CPU</span><br><span class="line">    </span><br><span class="line">6.          adapter: classification</span><br><span class="line">    </span><br><span class="line">7.      #定义数据集</span><br><span class="line">    </span><br><span class="line">8.      datasets:</span><br><span class="line">    </span><br><span class="line">9.       - name: classification_dataset</span><br><span class="line">    </span><br><span class="line">10.         #定义数据集路径</span><br><span class="line">    </span><br><span class="line">11.         data_source: /mnt/hdd-4t/data/hanyue/mobileNet/flower</span><br><span class="line">    </span><br><span class="line">12.         #定义annotation路径</span><br><span class="line">    </span><br><span class="line">13.         annotation_conversion:</span><br><span class="line">    </span><br><span class="line">14.           converter: imagenet</span><br><span class="line">    </span><br><span class="line">15.           annotation_file: /home/yuesang/Pythonproject/MobileNetV3/onnxinference/int8inference/my_annotation.txt</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">17.         reader: opencv_imread # default setting</span><br><span class="line">    </span><br><span class="line">18.         #这里需要提前定义预处理</span><br><span class="line">    </span><br><span class="line">19.         preprocessing:</span><br><span class="line">    </span><br><span class="line">20.          - type: resize</span><br><span class="line">    </span><br><span class="line">21.             size: 256</span><br><span class="line">    </span><br><span class="line">22.             aspect_ratio_scale: greater</span><br><span class="line">    </span><br><span class="line">23.          - type: crop</span><br><span class="line">    </span><br><span class="line">24.             size: 224</span><br><span class="line">    </span><br><span class="line">25.          - type: bgr_to_rgb # bgr format in opencv</span><br><span class="line">    </span><br><span class="line">26.          - type: normalization</span><br><span class="line">    </span><br><span class="line">27.             # you may specify precomputed statistics manually or use precomputed values, such as ImageNet as well</span><br><span class="line">    </span><br><span class="line">28.             mean: (123.675, 116.28, 103.53)</span><br><span class="line">    </span><br><span class="line">29.             std: (58.395, 57.12, 57.375)</span><br><span class="line">    </span><br><span class="line">30.         metrics:</span><br><span class="line">    </span><br><span class="line">31.          - name: accuracy @ top1</span><br><span class="line">    </span><br><span class="line">32.             type: accuracy</span><br><span class="line">    </span><br><span class="line">33.             top_k: 1</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后就是json文件的编写</p>
<h4 id="3-2-1-DefaultQuantization"><a href="#3-2-1-DefaultQuantization" class="headerlink" title="3.2.1 DefaultQuantization"></a><a href="#"></a>3.2.1 DefaultQuantization</h4><p>这个应该是openvino中的全int8的量化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">1.  &#123;</span><br><span class="line">    </span><br><span class="line">2.      &quot;model&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">3.          &quot;model_name&quot;: &quot;MobileNetV3&quot;, </span><br><span class="line">    </span><br><span class="line">4.          &quot;model&quot;: &quot;/home/yuesang/Pythonproject/MobileNetV3/runs/train/exp1/bestfp16.xml&quot;, </span><br><span class="line">    </span><br><span class="line">5.          &quot;weights&quot;: &quot;/home/yuesang/Pythonproject/MobileNetV3/runs/train/exp1/bestfp16.bin&quot; </span><br><span class="line">    </span><br><span class="line">6.      &#125;,</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">10.     &quot;engine&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">11.         &quot;config&quot;: &quot;/home/yuesang/Pythonproject/MobileNetV3/onnxinference/int8inference/defualtQuantization/model.yaml&quot;</span><br><span class="line">    </span><br><span class="line">12.     &#125;,</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">15.     &quot;compression&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">16.         &quot;target_device&quot;: &quot;CPU&quot;, </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">18.         &quot;algorithms&quot;: [</span><br><span class="line">    </span><br><span class="line">19.             &#123;</span><br><span class="line">    </span><br><span class="line">20.                 &quot;name&quot;: &quot;DefaultQuantization&quot;, </span><br><span class="line">    </span><br><span class="line">21.                 &quot;params&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">22.                     &quot;preset&quot;: &quot;performance&quot;,                      </span><br><span class="line">    </span><br><span class="line">23.                     &quot;stat_subset_size&quot;: 300  </span><br><span class="line">    </span><br><span class="line">24.                 &#125;</span><br><span class="line">    </span><br><span class="line">25.             &#125;</span><br><span class="line">    </span><br><span class="line">26.         ]</span><br><span class="line">    </span><br><span class="line">27.     &#125;</span><br><span class="line">    </span><br><span class="line">28. &#125;</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>model：里面定义的是你最开始量化后的xml和bin的路径以及指定你的设备</p>
<p>engine:就是你刚刚写好的yaml文件了</p>
<p>target_device：就是你要量化的设备</p>
<p>algorithms –</p>
<p>&nbsp;                       name：这里指定的是你的量化方式</p>
<p>&nbsp;                       preset：我也不知道什么意思</p>
<p>&nbsp;                       stat_subset_size: 好像是采取多少张数据集的意思</p>
<h4 id="3-2-2-AccuracyAwareQuantization"><a href="#3-2-2-AccuracyAwareQuantization" class="headerlink" title="3.2.2 AccuracyAwareQuantization"></a><a href="#"></a>3.2.2 AccuracyAwareQuantization</h4><p>先放一下json文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">1.  &#123;</span><br><span class="line">    </span><br><span class="line">2.      &quot;model&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">3.          &quot;model_name&quot;: &quot;MobileNetV3&quot;, </span><br><span class="line">    </span><br><span class="line">4.          &quot;model&quot;: &quot;/home/yuesang/Pythonproject/MobileNetV3/runs/train/exp1/bestfp16.xml&quot;, </span><br><span class="line">    </span><br><span class="line">5.          &quot;weights&quot;: &quot;/home/yuesang/Pythonproject/MobileNetV3/runs/train/exp1/bestfp16.bin&quot; </span><br><span class="line">    </span><br><span class="line">6.      &#125;,</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">10.     &quot;engine&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">11.         &quot;config&quot;: &quot;/home/yuesang/Pythonproject/MobileNetV3/onnxinference/int8inference/AccuracyAwareQuantization/model.yaml&quot;</span><br><span class="line">    </span><br><span class="line">12.     &#125;,</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">15.     &quot;compression&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">16.         &quot;target_device&quot;: &quot;CPU&quot;, </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">18.         &quot;algorithms&quot;: [</span><br><span class="line">    </span><br><span class="line">19.             &#123;</span><br><span class="line">    </span><br><span class="line">20.                 &quot;name&quot;: &quot;AccuracyAwareQuantization&quot;, </span><br><span class="line">    </span><br><span class="line">21.                 &quot;params&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">22.                     &quot;preset&quot;: &quot;performance&quot;,                      </span><br><span class="line">    </span><br><span class="line">23.                     &quot;stat_subset_size&quot;: 300  ,</span><br><span class="line">    </span><br><span class="line">24.                     &quot;maximal_drop&quot;: 0.1 </span><br><span class="line">    </span><br><span class="line">25.                 &#125;</span><br><span class="line">    </span><br><span class="line">26.             &#125;</span><br><span class="line">    </span><br><span class="line">27.         ]</span><br><span class="line">    </span><br><span class="line">28.     &#125;</span><br><span class="line">    </span><br><span class="line">29. &#125;</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>想比于DefaultQuantization就是name里面那个不一样以及多了一个maximal_drop,这个参数的意义是运行你的模型下降多少指标</p>
<p>准确度的测试脚本可以用我3.1讲到的那个部分来测试只要把模型替换掉就OK了</p>
<p>但是Openvino的量化好像只支撑分类网络和目标检测，后续找个时间写一下有关Pytorch自带的QAT的量化方法</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/09/Jeston%20nx/Jetson%20Xavier%20NX%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEubuntu20.04_jetson%20ubuntu20.04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/Jeston%20nx/Jetson%20Xavier%20NX%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEubuntu20.04_jetson%20ubuntu20.04/" class="post-title-link" itemprop="url">Jetson Xavier NX环境配置ubuntu20.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 10:37:19 / 修改时间：11:16:27" itemprop="dateCreated datePublished" datetime="2024-01-09T10:37:19+08:00">2024-01-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" itemprop="url" rel="index"><span itemprop="name">环境配置</span></a>
                </span>
            </span>

          
            <span id="/2024/01/09/Jeston%20nx/Jetson%20Xavier%20NX%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEubuntu20.04_jetson%20ubuntu20.04/" class="post-meta-item leancloud_visitors" data-flag-title="Jetson Xavier NX环境配置ubuntu20.04" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/09/Jeston%20nx/Jetson%20Xavier%20NX%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEubuntu20.04_jetson%20ubuntu20.04/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/09/Jeston%20nx/Jetson%20Xavier%20NX%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEubuntu20.04_jetson%20ubuntu20.04/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Jetson-Xavier-NX环境配置ubuntu20-04"><a href="#Jetson-Xavier-NX环境配置ubuntu20-04" class="headerlink" title="Jetson Xavier NX环境配置ubuntu20.04"></a>Jetson Xavier NX环境配置ubuntu20.04</h1><p><strong>特别感谢淘宝老哥有问必答，这里为他写个教程减轻老哥的工作负担。</strong></p>
<p><strong>安装上nx的版本和你的虚拟机的系统没有关系和安装的jetpack的版本有关系</strong></p>
<p><strong>这里我先装在sd卡上的原因是因为nx默认sd卡启动，你就算装在固态中但是系统也还是默认sd卡启动需要在后面的操作中把它转到固态中。</strong></p>
<h2 id="一-准备事项"><a href="#一-准备事项" class="headerlink" title="一.准备事项"></a><a id="t0"></a>一.准备事项</h2><p>有条件的话最好有台装ubuuntu的主机，因为nx安装的过程中会经常断线重连，有时候虚拟机的话会识别不到。这里不要ubuntu的版本不要用22的版本我测试过22的版本我没有办法进行安装（也有可能是我的问题）</p>
<p>这里我用的是Ubuntu20.04的镜像和vmware16，先在虚拟机上面进行安装然后再拷贝到nx的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ssd&spm=1001.2101.3001.7020">ssd</a>固态里面，我的nx是国产套件没有sd卡所以直接在虚拟机上面直接进行安装。</p>
<p>虚拟机安装还有一个好处就是你在虚拟机环境安装完成之后万一那天你的nx又炸了你只需要格式化你的固态（这里建议买一个固态的转换口tb好像还挺贵的…..）然后直接把之前安装好的镜像直接导入即可。</p>
<h2 id="二-虚拟机"><a href="#二-虚拟机" class="headerlink" title="二.虚拟机"></a><a id="t1"></a>二.虚拟机</h2><p>创建一个虚拟机</p>
<img width="1200" height="716" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/5c3fc4ef67c74adaad2dac54aa8362d6_c4866f084ca842509.png"/>

<p>&nbsp;选择你镜像的位置</p>
<p><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/8bf7d1a07742442f8a1dad6722034882_a90d1f4114a643c0a.png"></p>
<p>&nbsp;分配内存的时候建议给大点60Gcbd<img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/ad09ddb431454a2fa218542df02b4b3f_6f85f6d3e69242fea.png"></p>
<p>&nbsp;然后就是Ubuntu的安装</p>
<img width="1200" height="566" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/1cf9d6b16a0b4017b4538bfc1183f121_d5c1955fe25a4eb7b.png"/>

<h2 id="三-Nvidia-sdk的安装"><a href="#三-Nvidia-sdk的安装" class="headerlink" title="三.Nvidia sdk的安装"></a><a id="t2"></a>三.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Nvidia&spm=1001.2101.3001.7020">Nvidia</a> sdk的安装</h2><p>进入官网：<a target="_blank" rel="noopener" href="https://developer.nvidia.com/zh-cn/embedded/jetpack" title="JetPack SDK | NVIDIA Developer">JetPack SDK | NVIDIA Developer</a>（怕你们英文不好给你们的是中文的官网）</p>
<p>选择SDK，这里需要登录自己个人的Nvidia账号</p>
<img width="1200" height="265" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/334d7bc0a53a44238cdc9a974d519335_d9a5cd189cca43bf9.png"/>

<p>或者直接在虚拟机内进行下载，我这里选择直接从主机拖拽到虚拟机内因为我有安装vmware-tools</p>
<p>输入指令进行安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ./sdkmanager_1.6.1-8175_amd64.deb ./sdkmanager_1.6.1-8175_amd64.deb </span><br></pre></td></tr></table></figure>

<p>安装完成后输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sdkmanager </span><br></pre></td></tr></table></figure>

<p>出现这个页面就代表着安装完成，然后登录一下自己的开发者账号<img width="1200" height="683" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/f908305664a549f89fd4ce6255e7bb79_9bad16fe03e549b2a.png"/></p>
<p>&nbsp;成功进入后的界面</p>
<img width="1200" height="538" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/280f402d5b694c76a2e3628bfeaa7a27_fc90091e5c784de29.png"/>

<p>&nbsp;之后用杜邦线或者跳线帽短接FC REC和GND（第二个引脚和第三个引脚）</p>
<img width="1200" height="900" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/4961d70182784916b20317e1236886d4_139acd134902413da.jpeg"/>

<p>&nbsp;接通电脑和电源，在虚拟机界面会弹出外接移动设备选择到你装sdk的这个虚拟机上面就可以了。（操作太快忘记截图了）</p>
<img width="1200" height="754" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/77e573f67f9f40199e5caa33b8923313_cb2cad02f62a485ea.png"/>

<p>&nbsp;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=jetpack&spm=1001.2101.3001.7020">jetpack</a>选择5.01dp(官网安装的是16版本但是下载完以后会跳出更新，更新完应该是18，而且这个版本和ubuntu的版本没有关系，实际系统的版本取决于你的选中的JetPack版本)，这里我选择5.0.1dp版本，因刷写系统在模组上运行，故Host Machine可不勾选</p>
<img width="1200" height="786" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/d7fa0a14d5314344a9434710f3566d3d_1adf6993b90a49bb9.png"/>

<p>deepstream我也不知道干啥的先装上去吧</p>
<img width="1200" height="739" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/3088901daf4e4797ba11f40815847e13_c095e4de1028465d9.png"/>

<p>&nbsp;然后只装os</p>
<img width="1200" height="755" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/3dad96f2e89246fa9f125d39854d3029_16bbe216a1534e7fa.png"/>

<p>&nbsp;到这步应该就没有问题了（网络不好的可以多等等）</p>
<img width="1200" height="567" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/88f66fe2f1de47d086158bd432973cdc_0f38c70ef9bc44ea9.png"/>

<p>&nbsp;完成后跳出了这个页面（按照这个选择）</p>
<img width="1200" height="708" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/d8d63fe71f2a4258878c580f25fc83f7_6fd232e7711b4a36b.png"/>

<p>&nbsp;然后安装完成后外接显示屏到nx像配置Ubuntu一样配置完成就OK了</p>
<img width="1200" height="675" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/5f2b93da5fcc4c1f95c6f060e9969a25_078780d3047e4e72a.png"/>

<p>查看一下我们装的系统版本是否是正确的.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/lsb-release</span><br></pre></td></tr></table></figure>

<p>&nbsp;大功告成</p>
<img width="1200" height="675" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/6430965d7e1d412a9eee86a5023910c1_7314436ee52444f6b.png"/>

<h2 id="四将SSD设置成默认启动盘"><a href="#四将SSD设置成默认启动盘" class="headerlink" title=" 四将SSD设置成默认启动盘"></a><a id="t3"></a> 四将SSD设置成默认启动盘</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git</span><br></pre></td></tr></table></figure>

<p>输入disk,我这里是16g运存所以我分16g，剩下全部给系统就可以了</p>
<img width="1200" height="675" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/e9f08d9d32e746efae8bdf3ce3a0c6ef_6c1a1b765ade440aa.png"/>

<p>jinru</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">1.  git clone https://github.com/jetsonhacks/rootOnNVMe.git</span><br><span class="line">    </span><br><span class="line">2.  cd rootOnNVMe</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./copy-rootfs-ssd.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./setup-service.sh</span><br></pre></td></tr></table></figure>

<p>进入新的系统后在root打开属性查看一下空间就知道有没有成功了。</p>
<p>完成！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/09/Jeston%20nx/Jeston%20nx%E5%AE%89%E8%A3%85cuda,cudann,tenorrt%E5%B9%B6%E4%B8%94%E5%8D%B8%E8%BD%BD%E5%8E%9F%E5%85%88%E7%9A%84opencv%EF%BC%88JectPa/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/Jeston%20nx/Jeston%20nx%E5%AE%89%E8%A3%85cuda,cudann,tenorrt%E5%B9%B6%E4%B8%94%E5%8D%B8%E8%BD%BD%E5%8E%9F%E5%85%88%E7%9A%84opencv%EF%BC%88JectPa/" class="post-title-link" itemprop="url">Jeston nx安装cuda,cudann,tenorrt并且卸载原先的opencv（JectPack 5.01）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-09 10:37:19 / 修改时间：11:19:12" itemprop="dateCreated datePublished" datetime="2024-01-09T10:37:19+08:00">2024-01-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" itemprop="url" rel="index"><span itemprop="name">环境配置</span></a>
                </span>
            </span>

          
            <span id="/2024/01/09/Jeston%20nx/Jeston%20nx%E5%AE%89%E8%A3%85cuda,cudann,tenorrt%E5%B9%B6%E4%B8%94%E5%8D%B8%E8%BD%BD%E5%8E%9F%E5%85%88%E7%9A%84opencv%EF%BC%88JectPa/" class="post-meta-item leancloud_visitors" data-flag-title="Jeston nx安装cuda,cudann,tenorrt并且卸载原先的opencv（JectPack 5.01）" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/09/Jeston%20nx/Jeston%20nx%E5%AE%89%E8%A3%85cuda,cudann,tenorrt%E5%B9%B6%E4%B8%94%E5%8D%B8%E8%BD%BD%E5%8E%9F%E5%85%88%E7%9A%84opencv%EF%BC%88JectPa/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/09/Jeston%20nx/Jeston%20nx%E5%AE%89%E8%A3%85cuda,cudann,tenorrt%E5%B9%B6%E4%B8%94%E5%8D%B8%E8%BD%BD%E5%8E%9F%E5%85%88%E7%9A%84opencv%EF%BC%88JectPa/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Jeston-nx安装cuda-cudann-tenorrt并且卸载原先的opencv（JectPack-5-01）"><a href="#Jeston-nx安装cuda-cudann-tenorrt并且卸载原先的opencv（JectPack-5-01）" class="headerlink" title="Jeston nx安装cuda,cudann,tenorrt并且卸载原先的opencv（JectPack 5.01）"></a>Jeston nx安装cuda,cudann,tenorrt并且卸载原先的opencv（JectPack 5.01）</h1><p>这里我把nx分成了两个部分进行安装：系统的安装和cuda的安装。这样做的原因是因为在<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AE%89%E8%A3%85cuda&spm=1001.2101.3001.7020">安装cuda</a>这些组件的时候nx需要联网，在有网线的情况下可以通过网线连接WIFE口进行直接安装之后再按照我另外一篇博客中直接把这些插件勾选上去就可以了之后把sd卡的系统拷贝到固态中，（很可惜公司WIFE离我太远了，刚好又没有网线本来想尝试从电脑桥接网络到nx上），没有网线的话我们先安装系统之后连接上WIFE之后再cuda这些组件的安装。（nx基础环境的安装可以查看我的上一篇博客）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/apt/sources.list</span><br></pre></td></tr></table></figure>

<p>这里有个很狗的坑，我在安装的时候杜邦线忘记拔下来导致系统一直无法被主机识别，ip地址一直不对。</p>
<p>之后把nx接数据线到主机上面（记得杜邦线不要短接！！！记得杜邦线不要短接！！！记得杜邦线不要短接！！！重要的事情说三遍）</p>
<h2 id="一-准备事项"><a href="#一-准备事项" class="headerlink" title="一.准备事项"></a><a id="t0"></a>一.准备事项</h2><p>首先我们先换个源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/apt/sources.list</span><br></pre></td></tr></table></figure>

<p>注意JetPack5.0.1是ubuntu20了，后缀是focal，开发板还要带上ports：(记得开发板的要是ubuntu-port之前换源一直出错就是因为换错了)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">1.  deb https://mirrors.ustc.edu.cn/ubuntu-ports/ focal main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">2.  deb https://mirrors.ustc.edu.cn/ubuntu-ports/ focal-updates main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">3.  deb https://mirrors.ustc.edu.cn/ubuntu-ports/ focal-backports main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line">4.  deb https://mirrors.ustc.edu.cn/ubuntu-ports/ focal-security main restricted universe multiverse</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>进入主机的sdk界面host不用勾选（这个选项是为了安装cuda这些东西到你的主机上面，看很多博客说这样安装大概率会用不了）</p>
<img width="1200" height="675" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/745ba610764a440895475ba8d1aa28d1_2be41ad5b386494d8.png"/>

<p>在这里Jeston os不用勾选，如果你勾选的换就默认重装系统了 <img width="1200" height="675" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/daf6336878d94e8e8a0f7121b9b452c1_d840294fbb1b49ce9.png"/></p>
<p>&nbsp;ip地址一般默认不用改变如果实在不知道的话可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname -I</span><br></pre></td></tr></table></figure>

<p>来查看你的ip如果有连WIFE的话可能会出现两个这里你两个都试试一般就可以了，然后输入你的用户名和密码</p>
<img width="1200" height="675" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/6319a52dd2ab4669a59e17520f708772_839888ab3d0f4cd6a.png"/>

<p>&nbsp;等这三个选项全部打勾以后开始安装<img width="1200" height="675" src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/b59586872bf445afa5219503d1d9181a_89a9e6a610604b49b.png"/></p>
<p>安装完成后先安装pip3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3-pip</span><br></pre></td></tr></table></figure>

<p>安装jtop(一定要加后面的版本这个版本是支持5.0以上的)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -H pip install jetson-stats==4.0.0rc2</span><br></pre></td></tr></table></figure>

<h2 id="二-opencv的卸载"><a href="#二-opencv的卸载" class="headerlink" title="二.opencv的卸载"></a><a id="t1"></a>二.opencv的卸载</h2><p>（最近公司加班多找个时间把这个部分补上）</p>
<p> </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96%E5%99%A8/" class="post-title-link" itemprop="url">神经网络优化器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-08 17:43:59" itemprop="dateCreated datePublished" datetime="2024-01-08T17:43:59+08:00">2024-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-09 11:15:30" itemprop="dateModified" datetime="2024-01-09T11:15:30+08:00">2024-01-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">神经网络</span></a>
                </span>
            </span>

          
            <span id="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96%E5%99%A8/" class="post-meta-item leancloud_visitors" data-flag-title="神经网络优化器" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96%E5%99%A8/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96%E5%99%A8/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="优化器"><a href="#优化器" class="headerlink" title="优化器"></a>优化器</h1><h2 id="1-神经网络的梯度"><a href="#1-神经网络的梯度" class="headerlink" title="1.神经网络的梯度"></a>1.神经网络的梯度</h2><h3 id="1-1梯度"><a href="#1-1梯度" class="headerlink" title="1.1梯度"></a>1.1梯度</h3><p>下面是如何求解导数</p>
<p>$$<br>\frac{df(x)}{dx}&#x3D;\lim\limits_{x\rightarrow\infty}\frac{f(x+h)-f(x)}{h}<br>$$</p>
<p>举个例子速度的导数是加速反应了速度变换的快慢，所以在神经网络中导数往往决定方向下降的快慢。<br>下面是一个偏导数</p>
<p>$$<br>f(x_0,x_1)&#x3D;x_0^2+x_1^2<br>$$</p>
<p>可以将神经网络中的神经元理解为这些自变量，而梯度则是对这些自变量求导，我们将他称之为偏导数（求哪个自变量就是对他比较偏心），这些偏导数称之为模型的梯度。</p>
<h3 id="1-2梯度法"><a href="#1-2梯度法" class="headerlink" title="1.2梯度法"></a>1.2梯度法</h3><p>根据高中学习的知识可以知道，函数的极值出现在导数为0的部分，也就是梯度为0的部分。函数可能有多个极值点由此可见梯度下降可能会出现的一个就是局部最优解。<br><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_16921678799643.png"><br>梯度法的过程就是土话来说，我先确认一个方向向前跑几步，然后再求梯度之后再跑几步，其中这个具体跑几步就要由我们的学习率来决定了。<br>给出梯度下降的公式：<br>$$<br>x_0&#x3D;x_0-\eta\dfrac{\partial f}{\partial x_0}<br>$$<br>$$<br>x_1&#x3D;x_1-\eta\dfrac{\partial f}{\partial x_1}<br>$$<br>其中$\eta$就是神经网络中的学习率</p>
<h2 id="2神经网络动量"><a href="#2神经网络动量" class="headerlink" title="2神经网络动量"></a>2神经网络动量</h2><h3 id="2-1一阶动量和二阶动量"><a href="#2-1一阶动量和二阶动量" class="headerlink" title="2.1一阶动量和二阶动量"></a>2.1一阶动量和二阶动量</h3><p>通过高中物理知识可以知道动量的概念是物体在它运动方向上保持运动的趋势，是该物体质量和速度的乘积。土话来举个例子，孙策开大下船的时候船会往我们指定方向运动这就是动量。<br>一阶动量为过去各个时刻梯度的线性组合，而二阶动量自然是过去各个时刻梯度的平方的线性组合，虽然一阶动量确认梯度下降的路程，二阶动量确认梯度下降的速度。。<br>动量法的一般形式,先确定梯度：<br>$$<br>g_t&#x3D;\nabla loss&#x3D;\dfrac{\partial loss}{\partial \omega_t}<br>$$<br>这就和我上述讲的损失函数差不多对损失函数的每个权重求偏导的出来的就是权重。<br>这俩是一阶动量和二阶动量的表达式<br>$$<br>m_{t}&#x3D;\phi\left(g_{1}, g_{2}, \cdots, g_{t}\right) ; V_{t}&#x3D;\psi\left(g_{1}, g_{2}, \cdots, g_{t}\right)<br>$$<br>当前时刻下降的梯度<br>$$<br>\eta_t&#x3D;\alpha·\dfrac{m_t}{\sqrt{V_t}}<br>$$<br>根据下降的梯度进行更新<br>$$<br> \omega_{t+1}&#x3D; \omega_t-\eta_t<br>$$</p>
<h3 id="2-2-一阶矩和二阶矩"><a href="#2-2-一阶矩和二阶矩" class="headerlink" title="2.2 一阶矩和二阶矩"></a>2.2 一阶矩和二阶矩</h3><p>假设梯度$g$是个随机变量，他的一阶矩就是他的期望，二阶矩就是方差（根据概率统计的定义得到的，高阶矩的目的就是为了验证概率$p(x)$是否随着x的增大而变小）</p>
<h3 id="2-3-动量法"><a href="#2-3-动量法" class="headerlink" title="2.3 动量法"></a>2.3 动量法</h3><p>首先动量法的表达式如下：<br>$$<br> \eta_{t}&#x3D;\gamma \eta_{t-1}+\alpha g_{t}<br>$$<br>$$<br> w_{t+1}&#x3D;w_{t}-\eta_{t}<br>$$<br>如何将他转到之前定义下降的梯度$\eta_t&#x3D;\alpha·\dfrac{m_t}{\sqrt{V_t}}$，我们做一下转换：<br>为了防止大家看不懂在写一个$t&#x3D;1$时刻$\eta_0$的状态<br>$$<br>\eta_1&#x3D;\alpha g_1<br>$$<br>$$<br>\begin{array}{l}<br>\eta_{t}&#x3D;\gamma \eta_{t-1}+\alpha g_{t} \<br>&#x3D;\gamma^2 \eta_{t-2}+\gamma \alpha g_{t-1}+\alpha g_{t} \<br>&#x3D;\gamma^3 \eta_{t-3}+\gamma^{2} \alpha g_{t-2}+\gamma \alpha g_{t-1}+\alpha g_{t} \<br>&#x3D;\cdots \<br>&#x3D;\gamma^{t-1} \alpha g_{1}+\gamma^{t-2} \alpha g_{2}+\cdots+\gamma^{0}\alpha g_{t}<br>\end{array}<br>$$<br>大家通常也跑过优化器的代码应该知道$\gamma$通常取小于1的值所以$\gamma$离当前时刻越远占的权重就越小，这个叫做指数加权移动平均。虽然，动量法的一阶动量不是取过去所有时间步梯度的平均，但同样能用来控制模型更新的方向，动量法以来指数加权平均使得自变量的更新方向更加一致。而动量法的二阶梯度取为1，所以常说动量法只利用了一阶梯度的信息。</p>
<h3 id="2-4-SGD"><a href="#2-4-SGD" class="headerlink" title="2.4 SGD"></a>2.4 SGD</h3><p>SGD中他的一阶动量和二阶动量定义如下<br>$$<br>m_{t}&#x3D;g_{t};V_{t}&#x3D;I^2<br>$$<br>因此他的当前时刻下降的梯度为<br>$$<br>\eta_t&#x3D;\alpha·g_{t}<br>$$<br>SGD最大的缺点是下降速度慢，而且可能会在凹凸的两边持续震荡，停留在一个局部最优点。</p>
<h3 id="2-5-SGD-with-Momentum"><a href="#2-5-SGD-with-Momentum" class="headerlink" title="2.5 SGD with Momentum"></a>2.5 SGD with Momentum</h3><p>为了抑制SGD的震荡，SGDM认为梯度下降过程可以加入惯性。下坡的时候，如果发现是陡坡，那就利用惯性跑的快一些。SGDM全称是SGD with momentum，在SGD基础上引入了一阶动量：<br>$$<br>m_t&#x3D;\beta_1<em>m_{t-1}+(1-\beta)·g_t<br>$$<br>我们将这个式子换一个形式先将他展开：<br><font color="red"><br>$$<br>m_t&#x3D;\beta_1</em>m_{t-1}+g_t-\beta_1·g_t<br>$$<br></font><br>之后我们合并一下同类项：</p>
<p>$$<br>m_t&#x3D;g_t+\beta_1*(m_{t-1}-g_t)<br>$$<br>这个式子有没有类似与卡尔曼滤波中的后验估计的求解。<br>卡尔曼是用测量值-先验值，这里是用先验值-测量值。<br>相当于他这个求的是$\dfrac{1}{1-\beta_1}$个时刻的平均值，但是此时这个$\beta_1$是个超参数是个定值一般取$0.9$</p>
<p>这个解决了SGD中收敛缓慢的问题但是还有一个局部最优的问题没有解决。</p>
<h3 id="2-6-SGD-with-Nesterov-Acceleration"><a href="#2-6-SGD-with-Nesterov-Acceleration" class="headerlink" title="2.6 SGD with Nesterov Acceleration"></a>2.6 SGD with Nesterov Acceleration</h3><p>先给出他的改进点主要在第一步：<br>$$<br>g_{t}&#x3D;\nabla f\left(w_{t}-\alpha \cdot m_{t-1} &#x2F; \sqrt{V_{t-1}}\right)<br>$$<br>根据上面的表达式我们可以知道$\alpha \cdot m_{t-1} &#x2F; \sqrt{V_{t-1}}$代表的是当前时刻的梯度因此先下降一步，相当于走出去看看，不行就回去。</p>
<h3 id="2-7-AdaGrad"><a href="#2-7-AdaGrad" class="headerlink" title="2.7 AdaGrad"></a>2.7 AdaGrad</h3><p>这里给出二阶动量的表达式:<br>$$<br>V_t&#x3D; {\textstyle \sum_{t}^{T&#x3D;1}} g_T^2<br>$$<br>表示所有梯度值的平方，因此我们此时的学习率变成了$\alpha&#x2F;\sqrt{V_t}$,当梯度整体下降的慢也就是速度较小的时候，相当于学习率会大一点加快下降的速度。<br>在这之前我提到过高阶矩的目的，这里大家可以去详细了解一下高阶矩，他有个好记的特性就是对极大值特别的敏感，随着梯度越大下降的速度应该更快。<br>这里因为$\sqrt{V_t}$是个单调递增的函数，所以学习率可能下降的很快导致有一些特征没有学到这就是他的缺点。</p>
<h3 id="2-8AdaDelta-RMSProp"><a href="#2-8AdaDelta-RMSProp" class="headerlink" title="2.8AdaDelta &#x2F; RMSProp"></a>2.8AdaDelta &#x2F; RMSProp</h3><p>这个方法和SGD with Momentum有点相似不过他这里是为了防止学习率太低的情况，<br>$$<br>V_t&#x3D;\beta_2*V_{t-1}+(1-\beta_2)·g_t^2<br>$$</p>
<h3 id="2-9Adam"><a href="#2-9Adam" class="headerlink" title="2.9Adam"></a>2.9Adam</h3><p>阿蛋优化器集合了一阶动量以及二阶动量的特点：<br>$$<br>m_t&#x3D;\beta_1*m_{t-1}+(1-\beta)·g_t<br>$$</p>
<p>$$<br>V_t&#x3D;\beta_2*V_{t-1}+(1-\beta_2)·g_t^2<br>$$</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1/" class="post-title-link" itemprop="url">交叉熵损失</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-08 17:43:59" itemprop="dateCreated datePublished" datetime="2024-01-08T17:43:59+08:00">2024-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-09 11:15:16" itemprop="dateModified" datetime="2024-01-09T11:15:16+08:00">2024-01-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">神经网络</span></a>
                </span>
            </span>

          
            <span id="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1/" class="post-meta-item leancloud_visitors" data-flag-title="交叉熵损失" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E4%BA%A4%E5%8F%89%E7%86%B5%E6%8D%9F%E5%A4%B1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1信息量"><a href="#1信息量" class="headerlink" title="1信息量"></a>1信息量</h1><p>一件事情发生的概率越大信息量就会越少，举个例子国足每年都踢不进世界杯，这件事发生概率极大，大家都习以为常，但是假如有一年国足踢进的话，那这信息量就很大了，因为事情发生的概率极小。<br>若事件$x$发生的概率为$P(x)$,则信息量的计算公式为:<br>$$<br>I(x)&#x3D;-\log(P(x))<br>$$<br>$\log$的底你可以随意取，但是在神经网络一般取e,这里拿一张别人的图<br><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/059755e389e74059a0eef42704677f81.png"><br>由图我们可以看出当log的底大于1，log的图形就像下图红色线，因为$P(x)$为概率的取值范围是$[0-1]$从图像可以看出满足我们上述对信息量的要求。</p>
<h1 id="2信息熵"><a href="#2信息熵" class="headerlink" title="2信息熵"></a>2信息熵</h1><p>信息熵也被称为熵，用来表示所有信息量的期望，期望是试验中每次可能结果的概率乘以其结果的总和。<br>$$<br>H(x)&#x3D;-\sum_{i&#x3D;1}^{n}  P(x_{i})·\log(P(x_i))<br>$$</p>
<h1 id="3KL散度（相对熵）"><a href="#3KL散度（相对熵）" class="headerlink" title="3KL散度（相对熵）"></a>3KL散度（相对熵）</h1><p>机器学习中，常常用$P(x)$表示样本的真实分布，用$Q(x)$表示模型预测的分布，比如在一个五分类任务中（猫狗马鸟人分类器），$[x1,x2,x3,x4,x5]$分别表示猫狗马鸟人的概率,此时输入一张狗的照片其真实分布为$P(x)&#x3D;[0,0,0,0,1]$那么$P(x)$和$Q(x)$就是两个不同的概率分布，可以用KL散度来计算他们的差异：<br>$$<br>D_{K L}(p | q)&#x3D;\sum_{i&#x3D;1}^{N}\left[p\left(x_{i}\right) \log p\left(x_{i}\right)-p\left(x_{i}\right) \log q\left(x_{i}\right)\right]<br>$$<br>怎么将KL散度转换到交叉熵呢,首先我们变形一下<br>$$<br>D_{K L}(p | q)&#x3D;\sum_{i&#x3D;1}^{N}\left[p\left(x_{i}\right) \log p\left(x_{i}\right)-p\left(x_{i}\right) \log q\left(x_{i}\right)\right]<br>\&#x3D;-\sum_{i&#x3D;1}^{N}p(x_i)\log(q(x_i))-H(p(x))<br>$$<br>由上式我们可以得到KL散度&#x3D;交叉熵-信息熵</p>
<p>交叉熵是用来衡量两个概率分布的距离(也可以叫差别)。概率分布：即$[0.1,0.5,0.2,0.1,0.1]$，每个类别的概率都在$0~1$，且加起来为$1$。交叉熵的公式为：<br>$$<br>H(p,q)&#x3D;-\sum_{i&#x3D;1}^{N}p(x_i)\log(q(x_i))<br>$$</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yuesangshuai.github.io/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/YOLOV8%E5%92%8CYOLOV5%E5%AF%B9%E6%AF%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
      <meta itemprop="name" content="YueSang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你好陌生人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/YOLOV8%E5%92%8CYOLOV5%E5%AF%B9%E6%AF%94/" class="post-title-link" itemprop="url">YOLOV8和YOLOV5对比</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-08 17:43:59" itemprop="dateCreated datePublished" datetime="2024-01-08T17:43:59+08:00">2024-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-09 11:16:04" itemprop="dateModified" datetime="2024-01-09T11:16:04+08:00">2024-01-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">神经网络</span></a>
                </span>
            </span>

          
            <span id="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/YOLOV8%E5%92%8CYOLOV5%E5%AF%B9%E6%AF%94/" class="post-meta-item leancloud_visitors" data-flag-title="YOLOV8和YOLOV5对比" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/YOLOV8%E5%92%8CYOLOV5%E5%AF%B9%E6%AF%94/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/01/08/%E5%9C%9F%E8%AF%B4%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/YOLOV8%E5%92%8CYOLOV5%E5%AF%B9%E6%AF%94/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="YOLOV8和YOLOV5对比"><a href="#YOLOV8和YOLOV5对比" class="headerlink" title="YOLOV8和YOLOV5对比"></a>YOLOV8和YOLOV5对比</h1><h2 id="正负样本匹配策略"><a href="#正负样本匹配策略" class="headerlink" title="正负样本匹配策略"></a>正负样本匹配策略</h2><h3 id="yolov5"><a href="#yolov5" class="headerlink" title="yolov5"></a>yolov5</h3><p>yolov5:采用anchor-base策略</p>
<h4 id="1-跨anchor预测"><a href="#1-跨anchor预测" class="headerlink" title="1.跨anchor预测"></a>1.跨anchor预测</h4><p>在yolov3中一个GT只能由一个anchor负责预测具体是哪个anchor是看哪个anchor与这个GT的IOU最大。<br>在yolov5中一个GT可以由多个anchor负责预测，具体方法如下:<br>$<br>\frac {GT宽高}{anchors宽高}&#x3D;ration_1<br>$</p>
<p>$<br>\frac {anchors宽高}{GT宽高}&#x3D;ration_2<br>$<br>取ratio1和ratio2的最大值作为最后的宽高比，该宽高比和设定阈值（默认为4）比较，小于设定阈值的anchor则为匹配到的anchor。<br>给出一位老哥的代码比较能直观的理解这个<br>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">anchor_boxes=torch.tensor([[<span class="number">1.25000</span>, <span class="number">1.62500</span>],[<span class="number">2.00000</span>, <span class="number">3.75000</span>],[<span class="number">4.12500</span>, <span class="number">2.87500</span>]])</span><br><span class="line">gt_box=torch.tensor([<span class="number">5</span>,<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">ratio1=gt_box/anchor_boxes</span><br><span class="line">ratio2=anchor_boxes/gt_box</span><br><span class="line"><span class="comment">#这里的max最后取[0]代表着取值[1]是索引</span></span><br><span class="line">ratio=torch.<span class="built_in">max</span>(ratio1, ratio2).<span class="built_in">max</span>(<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(ratio)</span><br><span class="line"> </span><br><span class="line">anchor_t=<span class="number">4</span></span><br><span class="line">res=ratio&lt;anchor_t</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure></p>
<h4 id="2-跨grid预测"><a href="#2-跨grid预测" class="headerlink" title="2.跨grid预测"></a>2.跨grid预测</h4><p>  在v5之前的yolo都是假设GT落入某个预测分支的某个网格(预测分支在这里的意思就是yolo的三个检测头)，该网格有左、上、右、下4个邻域网格，根据GT框的中心位置，将最近的2个邻域网格也作为预测网格，也即一个GT框可以由3个网格来预测。<br>  (偷个别人的例子)<br> 计算例子：<br>GT box中心点处于grid1中，grid1被选中，为了增加增样本，grid1的上下左右grid为候选网格，因为GT中心点更靠近grid2和grid3，grid2和grid3也作为匹配到的网格，根据上步的anchor匹配结果，GT与anchor2、anchor3相匹配，因此GT在当前层匹配到的正样本有6个，分别为：grid1_anchor2，grid1_anchor3，grid2_anchor2，grid2_anchor3，grid3_anchor2，grid3_anchor3。<br><img src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/731986cd924df77e562fa23f6460f3ec.png"></p>
<h4 id="3-跨分支预测"><a href="#3-跨分支预测" class="headerlink" title="3.跨分支预测"></a>3.跨分支预测</h4><p>原先一个GT只能由一个分支进行预测，现在我们在每个分支上进行anchor的匹配和grid的匹配，只要满足上述的条件即为正样本。<br>详细的匹配策略可以根据这位大佬的debug一步步进行<br> [大佬教程]:<a target="_blank" rel="noopener" href="https://blog.csdn.net/u013066730/article/details/126969286">https://blog.csdn.net/u013066730/article/details/126969286</a></p>
<h3 id="yolov8"><a href="#yolov8" class="headerlink" title="yolov8"></a>yolov8</h3><p> yolov8采用的是anchor-free，其核心思路就是每个grid作为一个anchor,<br> $$<br>\text { alignmetric }&#x3D;s^\alpha +u^\beta<br>$$<br>其中，s 是预测类别分值，u 是预测框和真实框的ciou值，另外两个就是权重超参数了对于每个真实框，然后直接对align_metric匹配程度排序，选取topK个预测框作为正样本。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="YueSang"
      src="https://raw.githubusercontent.com/YueSangShuai/upload_imgs/master/微信图片_20240109114649.jpg">
  <p class="site-author-name" itemprop="name">YueSang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/YueSangShuai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;YueSangShuai" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/0102hanyue@gmail.com" title="E-Mail → 0102hanyue@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


<!-- recent posts -->
    <div class="links-of-blogroll motion-element links-of-blogroll-block">
        <div class="links-of-blogroll-title recent-posts-title">
	    <i class="fa fa-history " aria-hidden="true"></i>
            近期文章
	</div>
	<ul class="links-of-blogroll-list recent-posts-list">
	        <li class="my-links-of-blogroll-item">
		    <a href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%A9%B7%E8%8B%A6%E4%BA%BA%E6%B0%91%E5%A6%82%E4%BD%95%E7%94%A8%E7%A7%BB%E5%8A%A8%E5%9B%BA%E6%80%81%E9%85%8D%E7%BD%AEunbutu22.04_awesome-terminal-fonts-CS/" title="穷苦人民如何用移动固态配置unbutu22.04" target="">
		    穷苦人民如何用移动固态配置unbutu22.04
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%E9%83%A8%E7%BD%B2c++%20%E9%85%8D%E7%BD%AEopencv4.5.5,opencv_contrib4.5.5,%E4%BB%A5%E5%8F%8A/" title="ubuntu22部署c++ 配置opencv4.5.5,opencv_contrib4.5.5,以及opencv下的cuda（cuda11.6,cudnn8.4.1）" target="">
		    ubuntu22部署c++ 配置opencv4.5.5,opencv_contrib4.5.5,以及opencv下的cuda（cuda11.6,cudnn8.4.1）
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2024/01/09/ubuntu%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu22%20pycharm,cuda,cudnn%EF%BC%8Ctensorrt%E7%9A%84%E5%AE%89%E8%A3%85_ubuntu22%20l/" title="ubuntu22 pycharm,cuda,cudnn，tensorrt的安装" target="">
		    ubuntu22 pycharm,cuda,cudnn，tensorrt的安装
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2024/01/09/Openvino/Ubuntu19%20Openvion%20cmake%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91_cmake%20%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AAopenvino%E9%A1%B9%E7%9B%AE-C/" title="Ubuntu19 Openvion cmake源码编译" target="">
		    Ubuntu19 Openvion cmake源码编译
		    </a>
		</li>
	        <li class="my-links-of-blogroll-item">
		    <a href="/2024/01/09/Openvino/Openvino%E9%87%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%20Fp32%20Fp16%20int8_openvino%20int8-CSDN%E5%8D%9A%E5%AE%A2/" title="Openvino量化模型推理 Fp32 Fp16 int8" target="">
		    Openvino量化模型推理 Fp32 Fp16 int8
		    </a>
		</li>
	</ul>
    </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YueSang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'Ti1kR0paKsHBzpXZnrhRIx8g-gzGzoHsz',
      appKey     : 'fmLUyLzUTPYCOpcwoBJqCcSz',
      placeholder: "来了老弟",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
